import * as tslib_1 from "tslib";
import { EventEmitter, Injectable, NgZone } from '@angular/core';
import { Timeline } from 'vis-timeline';
/**
 * A service to create, manage and control VisTimeline instances.
 *
 * @export
 * @class VisTimelineService
 */
var VisTimelineService = /** @class */ (function () {
    function VisTimelineService(ngZone) {
        this.ngZone = ngZone;
        /**
         * Fired when the current time bar redraws.
         * The rate depends on the zoom level.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.currentTimeTick = new EventEmitter();
        /**
         * Fired when clicked inside the Timeline.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.click = new EventEmitter();
        /**
         * Fired when right-clicked inside the Timeline.
         * Note that in order to prevent the context menu from showing up,
         * default behavior of the event must be stopped.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.contextmenu = new EventEmitter();
        /**
         * Fired when double clicked inside the Timeline.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.doubleClick = new EventEmitter();
        /**
         * 	Fired after the dragging of a group is finished.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.groupDragged = new EventEmitter();
        /**
         * Fired once after each graph redraw.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.changed = new EventEmitter();
        /**
         * Fired repeatedly when the timeline window is being changed.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.rangechange = new EventEmitter();
        /**
         * Fired once after the timeline window has been changed.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.rangechanged = new EventEmitter();
        /**
         * Fired after the user selects or deselects items by tapping or holding them.
         * When a use taps an already selected item, the select event is fired again.
         * Not fired when the method setSelectionis executed.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.select = new EventEmitter();
        /**
         * Fired when the user moves the mouse over an item.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.itemover = new EventEmitter();
        /**
         * Fired when the user moves the mouse out of an item.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.itemout = new EventEmitter();
        /**
         * Fired repeatedly when the user is dragging the custom time bar.
         * Only available when the custom time bar is enabled.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.timechange = new EventEmitter();
        /**
         * Fired once after the user has dragged the custom time bar.
         * Only available when the custom time bar is enabled.
         *
         * @type {EventEmitter<any>}
         * @memberOf VisTimelineService
         */
        this.timechanged = new EventEmitter();
        this.events = new Map();
        this.timelines = {};
    }
    /**
     * Creates a new timeline instance.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {HTMLElement} container The HTML element that contains the timeline view.
     * @param {VisTimelineItems} items The initial timeline items.
     * @param {VisTimelineOptions} [options] The timeline options.
     *
     * @throws {Error} Thrown when timeline already exists.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.createWithItems = function (visTimeline, container, items, options) {
        if (this.timelines[visTimeline]) {
            throw new Error(this.alreadyExistsError(visTimeline));
        }
        this.timelines[visTimeline] = this.ngZone.runOutsideAngular(function () { return new Timeline(container, items, options); });
    };
    /**
     * Creates a new timeline instance.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {HTMLElement} container The HTML element that contains the timeline view.
     * @param {VisTimelineItems} items The initial timeline items.
     * @param {VisTimelineGroups} groups The initial timeline groups.
     * @param {VisTimelineOptions} [options] The timeline options.
     *
     * @throws {Error} Thrown when timeline already exists.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.createWithItemsAndGroups = function (visTimeline, container, items, groups, options) {
        if (this.timelines[visTimeline]) {
            throw new Error(this.alreadyExistsError(visTimeline));
        }
        this.timelines[visTimeline] = this.ngZone.runOutsideAngular(function () { return new Timeline(container, items, groups, options); });
    };
    /**
     * Add new vertical bar representing a custom time that can be dragged by the user.
     * The id is added as CSS class name of the custom time bar,
     * allowing to style multiple time bars differently.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {DateType} time Parameter time can be a Date, Number, or String, and is new Date() by default.
     * @param {IdType} [id] Parameter id can be Number or String and is undefined by default.
     * @returns {IdType} The method returns id of the created bar.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.addCustomTime = function (visTimeline, time, id) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].addCustomTime(time, id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Adjust the visible window such that it fits all items.
     * See also function focus(id).
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {TimelineAnimationOptions} [options] Optional options.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.fit = function (visTimeline, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].fit(options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Adjust the visible window such that the selected item is centered on screen.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType} id The id of the item.
     * @param {TimelineAnimationOptions} [options] Options options.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.focusOnId = function (visTimeline, id, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].focus(id, options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Adjust the visible window such that the selected items are centered on screen.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType[]} ids The item ids.
     * @param {TimelineAnimationOptions} [options] Optional options.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.focusOnIds = function (visTimeline, ids, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].focus(ids, options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Get the current time.
     * Only applicable when option showCurrentTime is true.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @returns {Date} The current time.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getCurrentTime = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getCurrentTime();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Retrieve the custom time from the custom time bar with given id.
     * Id is undefined by default.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType} [id] The time bar id.
     * @returns {Date} The custom time.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getCustomTime = function (visTimeline, id) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getCustomTime(id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Returns an Object with relevant properties from an event.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {Event} event The event.
     * @returns {VisTimelineEventPropertiesResult} Properties of an event
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getEventProperties = function (visTimeline, event) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getEventProperties(event);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Get the range of all the items as an object containing min: Date and max: Date.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @returns {{ min: Date, max: Date }} The min and max dates.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getItemRange = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getItemRange();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Get an array with the ids of the currently selected items.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @returns {IdType[]} The currently selected items.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getSelection = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getSelection();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Get an array with the ids of the currently visible items.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @returns {IdType[]} The currently visible items.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getVisibleItems = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getVisibleItems();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Get the current visible window.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @returns {{ start: Date, end: Date }} Returns an object with properties start: Date and end: Date.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.getWindow = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            return this.timelines[visTimeline].getWindow();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * 	Move the window such that given time is centered on screen.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {DateType} time Parameter time can be a Date, Number, or String.
     * @param {TimelineAnimationOptions} [options] Optional options.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.moveTo = function (visTimeline, time, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].moveTo(time, options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Force a redraw of the Timeline.
     * The size of all items will be recalculated.
     * Can be useful to manually redraw when option autoResize=false and the window has been resized,
     * or when the items CSS has been changed.
     *
     * @param {string} visTimeline The timeline name/identifier.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.redraw = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].redraw();
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Remove vertical bars previously added to the timeline via addCustomTime method.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType} id Parameter id is the ID of the custom vertical bar returned by addCustomTime method.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.removeCustomTime = function (visTimeline, id) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].removeCustomTime(id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set a current time.
     * This can be used for example to ensure that a client's time is synchronized
     * with a shared server time.
     * Only applicable when option showCurrentTime is true.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {DateType} time time can be a Date object, numeric timestamp, or ISO date string.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setCurrentTime = function (visTimeline, time) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setCurrentTime(time);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * 	Adjust the time of a custom time bar.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {DateType} time Parameter time can be a Date object, numeric timestamp, or ISO date string.
     * @param {IdType} [id] Parameter id is the id of the custom time bar, and is undefined by default.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setCustomTime = function (visTimeline, time, id) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setCustomTime(time, id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Adjust the title attribute of a custom time bar.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {string} title Parameter title is the string to be set as title.
     *                       Use empty string to hide the title completely.
     * @param {IdType} [id] Parameter id is the id of the custom time bar, and is undefined by default.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setCustomTimeTitle = function (visTimeline, title, id) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setCustomTimeTitle(title, id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set both groups and items at once.
     * Both properties are optional.
     * This is a convenience method for individually calling both setItems(items) and setGroups(groups).
     * Both items and groups can be an Array with Objects, a DataSet (offering 2 way data binding),
     * or a DataView (offering 1 way data binding).
     * For each of the groups, the items of the timeline are filtered on the property group,
     * which must correspond with the id of the group.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {{ groups?: VisTimelineGroups; items?: VisTimelineItems }} data The new timline data.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setData = function (visTimeline, data) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setData(data);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set a data set with groups for the Timeline.
     * For each of the groups, the items of the timeline are filtered on the property group,
     * which must correspond with the id of the group.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {VisTimelineGroups} groups a DataSet (offering 2 way data binding)
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setGroups = function (visTimeline, groups) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setGroups(groups);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set a data set with items for the Timeline.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {VisTimelineItems} items can be an Array with Objects, a DataSet (offering 2 way data binding)
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setItems = function (visTimeline, items) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setItems(items);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set or update options.
     * It is possible to change any option of the timeline at any time.
     * You can for example switch orientation on the fly.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {VisTimelineOptions} options The new options of the timeline.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setOptions = function (visTimeline, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setOptions(options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Select one item by its id.#
     * The currently selected items will be unselected.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType} id The id of the item that should be selected.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setSelectionToId = function (visTimeline, id) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setSelection(id);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Select multiple items by their id.
     * The currently selected items will be unselected.
     * To unselect all selected items, call `setSelection([])`.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {IdType[]} ids The ids of the irems that should be selected.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setSelectionToIds = function (visTimeline, ids) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setSelection(ids);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Set the current visible window.
     *
     * If the parameter value of start or end is null, the parameter will be left unchanged.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {DateType} start The parameters start can be a Date, Number, or String.
     * @param {DateType} end The parameters end can be a Date, Number, or String.
     * @param {TimelineAnimationOptions} [options] Optional options.
     *
     * @throws {Error} Thrown when timeline does not exist.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.setWindow = function (visTimeline, start, end, options) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].setWindow(start, end, options);
        }
        else {
            throw new Error(this.doesNotExistError(visTimeline));
        }
    };
    /**
     * Destroy the Timeline.
     * The timeline is removed from memory.
     * All DOM elements and event listeners are cleaned up.
     *
     * @param {string} visTimeline The timeline name/identifier.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.destroy = function (visTimeline) {
        if (this.timelines[visTimeline]) {
            this.timelines[visTimeline].destroy();
            delete this.timelines[visTimeline];
        }
    };
    /**
     * Activates an event.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {string} eventName The event name.
     * @param {boolean} preventDefault Stops the default behavior of the event.
     * @returns {boolean} Returns true when the event was activated.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.on = function (visTimeline, eventName, preventDefault) {
        if (this.timelines[visTimeline]) {
            this.events.set(eventName, new EventEmitter());
            // tslint:disable-next-line
            var that_1 = this;
            this.timelines[visTimeline].on(eventName, function (params) {
                var emitter = (that_1[eventName] || that_1.events.get(eventName));
                if (emitter) {
                    emitter.emit(params ? [visTimeline].concat(params) : visTimeline);
                }
                if (preventDefault && params.event) {
                    params.event.preventDefault();
                }
            });
            return true;
        }
        return false;
    };
    /**
     * Deactivates an event.
     *
     * @param {string} visTimeline The timeline name/identifier.
     * @param {string} eventName The event name.
     *
     * @memberOf VisTimelineService
     */
    VisTimelineService.prototype.off = function (visTimeline, eventName) {
        if (this.timelines[visTimeline]) {
            this.events.delete(eventName);
            this.timelines[visTimeline].off(eventName, undefined);
        }
    };
    /**
     * Get the event emitter associated with the specified event name.
     * @param {string} eventName The event name.
     * @returns {EventEmitter<any>} The event emitter of the specified event name.
     */
    VisTimelineService.prototype.getEmitter = function (eventName) {
        return this.events.get(eventName);
    };
    VisTimelineService.prototype.doesNotExistError = function (visTimeline) {
        return "Timeline with id " + visTimeline + " does not exist.";
    };
    VisTimelineService.prototype.alreadyExistsError = function (visTimeline) {
        return "Timeline with id " + visTimeline + " already exists.";
    };
    VisTimelineService.ctorParameters = function () { return [
        { type: NgZone }
    ]; };
    VisTimelineService = tslib_1.__decorate([
        Injectable()
    ], VisTimelineService);
    return VisTimelineService;
}());
export { VisTimelineService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlzLXRpbWVsaW5lLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtdmlzLyIsInNvdXJjZXMiOlsiY29tcG9uZW50cy90aW1lbGluZS92aXMtdGltZWxpbmUuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2pFLE9BQU8sRUFLTCxRQUFRLEVBSVQsTUFBTSxjQUFjLENBQUM7QUFFdEI7Ozs7O0dBS0c7QUFFSDtJQW9IRSw0QkFDVSxNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQXBIeEI7Ozs7OztXQU1HO1FBQ0ksb0JBQWUsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVwRTs7Ozs7V0FLRztRQUNJLFVBQUssR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUUxRDs7Ozs7OztXQU9HO1FBQ0ksZ0JBQVcsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVoRTs7Ozs7V0FLRztRQUNJLGdCQUFXLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFFaEU7Ozs7O1dBS0c7UUFDSSxpQkFBWSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBRWpFOzs7OztXQUtHO1FBQ0ksWUFBTyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTVEOzs7OztXQUtHO1FBQ0ksZ0JBQVcsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVoRTs7Ozs7V0FLRztRQUNJLGlCQUFZLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFFakU7Ozs7Ozs7V0FPRztRQUNJLFdBQU0sR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUUzRDs7Ozs7V0FLRztRQUNJLGFBQVEsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUU3RDs7Ozs7V0FLRztRQUNJLFlBQU8sR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUU1RDs7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VyxDQUFDLENBQUM7aUJBQ25FO2dCQUNELElBQUksY0FBYyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7b0JBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7aUJBQy9CO1lBQ0gsQ0FBQyxDQUFDLENBQUM7WUFFSCxPQUFPLElBQUksQ0FBQztTQUNiO1FBRUQsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNJLGdDQUFHLEdBQVYsVUFBVyxXQUFtQixFQUFFLFNBQWlCO1FBQy9DLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUMvQixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QixJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUM7U0FDdkQ7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLHVDQUFVLEdBQWpCLFVBQWtCLFNBQWlCO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVPLDhDQUFpQixHQUF6QixVQUEwQixXQUFtQjtRQUMzQyxPQUFPLHNCQUFvQixXQUFXLHFCQUFrQixDQUFDO0lBQzNELENBQUM7SUFFTywrQ0FBa0IsR0FBMUIsVUFBMkIsV0FBbUI7UUFDNUMsT0FBTyxzQkFBb0IsV0FBVyxxQkFBa0IsQ0FBQztJQUMzRCxDQUFDOztnQkFwbEJpQixNQUFNOztJQXJIYixrQkFBa0I7UUFEOUIsVUFBVSxFQUFFO09BQ0Esa0JBQWtCLENBMHNCOUI7SUFBRCx5QkFBQztDQUFBLEFBMXNCRCxJQTBzQkM7U0Exc0JZLGtCQUFrQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV2ZW50RW1pdHRlciwgSW5qZWN0YWJsZSwgTmdab25lIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBEYXRhR3JvdXBDb2xsZWN0aW9uVHlwZSxcbiAgRGF0YUl0ZW1Db2xsZWN0aW9uVHlwZSxcbiAgRGF0ZVR5cGUsXG4gIElkVHlwZSxcbiAgVGltZWxpbmUsXG4gIFRpbWVsaW5lQW5pbWF0aW9uT3B0aW9ucyxcbiAgVGltZWxpbmVFdmVudFByb3BlcnRpZXNSZXN1bHQsXG4gIFRpbWVsaW5lT3B0aW9uc1xufSBmcm9tICd2aXMtdGltZWxpbmUnO1xuXG4vKipcbiAqIEEgc2VydmljZSB0byBjcmVhdGUsIG1hbmFnZSBhbmQgY29udHJvbCBWaXNUaW1lbGluZSBpbnN0YW5jZXMuXG4gKlxuICogQGV4cG9ydFxuICogQGNsYXNzIFZpc1RpbWVsaW5lU2VydmljZVxuICovXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgVmlzVGltZWxpbmVTZXJ2aWNlIHtcbiAgLyoqXG4gICAqIEZpcmVkIHdoZW4gdGhlIGN1cnJlbnQgdGltZSBiYXIgcmVkcmF3cy5cbiAgICogVGhlIHJhdGUgZGVwZW5kcyBvbiB0aGUgem9vbSBsZXZlbC5cbiAgICpcbiAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgY3VycmVudFRpbWVUaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8qKlxuICAgKiBGaXJlZCB3aGVuIGNsaWNrZWQgaW5zaWRlIHRoZSBUaW1lbGluZS5cbiAgICpcbiAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgY2xpY2s6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEZpcmVkIHdoZW4gcmlnaHQtY2xpY2tlZCBpbnNpZGUgdGhlIFRpbWVsaW5lLlxuICAgKiBOb3RlIHRoYXQgaW4gb3JkZXIgdG8gcHJldmVudCB0aGUgY29udGV4dCBtZW51IGZyb20gc2hvd2luZyB1cCxcbiAgICogZGVmYXVsdCBiZWhhdmlvciBvZiB0aGUgZXZlbnQgbXVzdCBiZSBzdG9wcGVkLlxuICAgKlxuICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPGFueT59XG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBjb250ZXh0bWVudTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiBkb3VibGUgY2xpY2tlZCBpbnNpZGUgdGhlIFRpbWVsaW5lLlxuICAgKlxuICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPGFueT59XG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBkb3VibGVDbGljazogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogXHRGaXJlZCBhZnRlciB0aGUgZHJhZ2dpbmcgb2YgYSBncm91cCBpcyBmaW5pc2hlZC5cbiAgICpcbiAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgZ3JvdXBEcmFnZ2VkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8qKlxuICAgKiBGaXJlZCBvbmNlIGFmdGVyIGVhY2ggZ3JhcGggcmVkcmF3LlxuICAgKlxuICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPGFueT59XG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBjaGFuZ2VkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8qKlxuICAgKiBGaXJlZCByZXBlYXRlZGx5IHdoZW4gdGhlIHRpbWVsaW5lIHdpbmRvdyBpcyBiZWluZyBjaGFuZ2VkLlxuICAgKlxuICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPGFueT59XG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyByYW5nZWNoYW5nZTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgb25jZSBhZnRlciB0aGUgdGltZWxpbmUgd2luZG93IGhhcyBiZWVuIGNoYW5nZWQuXG4gICAqXG4gICAqIEB0eXBlIHtFdmVudEVtaXR0ZXI8YW55Pn1cbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIHJhbmdlY2hhbmdlZDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgYWZ0ZXIgdGhlIHVzZXIgc2VsZWN0cyBvciBkZXNlbGVjdHMgaXRlbXMgYnkgdGFwcGluZyBvciBob2xkaW5nIHRoZW0uXG4gICAqIFdoZW4gYSB1c2UgdGFwcyBhbiBhbHJlYWR5IHNlbGVjdGVkIGl0ZW0sIHRoZSBzZWxlY3QgZXZlbnQgaXMgZmlyZWQgYWdhaW4uXG4gICAqIE5vdCBmaXJlZCB3aGVuIHRoZSBtZXRob2Qgc2V0U2VsZWN0aW9uaXMgZXhlY3V0ZWQuXG4gICAqXG4gICAqIEB0eXBlIHtFdmVudEVtaXR0ZXI8YW55Pn1cbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIHNlbGVjdDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiB0aGUgdXNlciBtb3ZlcyB0aGUgbW91c2Ugb3ZlciBhbiBpdGVtLlxuICAgKlxuICAgKiBAdHlwZSB7RXZlbnRFbWl0dGVyPGFueT59XG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBpdGVtb3ZlcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiB0aGUgdXNlciBtb3ZlcyB0aGUgbW91c2Ugb3V0IG9mIGFuIGl0ZW0uXG4gICAqXG4gICAqIEB0eXBlIHtFdmVudEVtaXR0ZXI8YW55Pn1cbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIGl0ZW1vdXQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEZpcmVkIHJlcGVhdGVkbHkgd2hlbiB0aGUgdXNlciBpcyBkcmFnZ2luZyB0aGUgY3VzdG9tIHRpbWUgYmFyLlxuICAgKiBPbmx5IGF2YWlsYWJsZSB3aGVuIHRoZSBjdXN0b20gdGltZSBiYXIgaXMgZW5hYmxlZC5cbiAgICpcbiAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgdGltZWNoYW5nZTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgb25jZSBhZnRlciB0aGUgdXNlciBoYXMgZHJhZ2dlZCB0aGUgY3VzdG9tIHRpbWUgYmFyLlxuICAgKiBPbmx5IGF2YWlsYWJsZSB3aGVuIHRoZSBjdXN0b20gdGltZSBiYXIgaXMgZW5hYmxlZC5cbiAgICpcbiAgICogQHR5cGUge0V2ZW50RW1pdHRlcjxhbnk+fVxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgdGltZWNoYW5nZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgcHJpdmF0ZSBldmVudHM6IE1hcDxzdHJpbmcsIEV2ZW50RW1pdHRlcjxhbnk+PiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIHRpbWVsaW5lczogeyBbaWQ6IHN0cmluZ106IFRpbWVsaW5lIH0gPSB7fTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIG5nWm9uZTogTmdab25lXG4gICkgeyB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgdGltZWxpbmUgaW5zdGFuY2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBjb250YWluZXIgVGhlIEhUTUwgZWxlbWVudCB0aGF0IGNvbnRhaW5zIHRoZSB0aW1lbGluZSB2aWV3LlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lSXRlbXN9IGl0ZW1zIFRoZSBpbml0aWFsIHRpbWVsaW5lIGl0ZW1zLlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lT3B0aW9uc30gW29wdGlvbnNdIFRoZSB0aW1lbGluZSBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgYWxyZWFkeSBleGlzdHMuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVXaXRoSXRlbXModmlzVGltZWxpbmU6IHN0cmluZywgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbXM6IERhdGFJdGVtQ29sbGVjdGlvblR5cGUsIG9wdGlvbnM/OiBUaW1lbGluZU9wdGlvbnMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5hbHJlYWR5RXhpc3RzRXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG5cbiAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0gPSB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBuZXcgVGltZWxpbmUoY29udGFpbmVyLCBpdGVtcywgb3B0aW9ucykpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgdGltZWxpbmUgaW5zdGFuY2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBjb250YWluZXIgVGhlIEhUTUwgZWxlbWVudCB0aGF0IGNvbnRhaW5zIHRoZSB0aW1lbGluZSB2aWV3LlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lSXRlbXN9IGl0ZW1zIFRoZSBpbml0aWFsIHRpbWVsaW5lIGl0ZW1zLlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lR3JvdXBzfSBncm91cHMgVGhlIGluaXRpYWwgdGltZWxpbmUgZ3JvdXBzLlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lT3B0aW9uc30gW29wdGlvbnNdIFRoZSB0aW1lbGluZSBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgYWxyZWFkeSBleGlzdHMuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVXaXRoSXRlbXNBbmRHcm91cHMoXG4gICAgdmlzVGltZWxpbmU6IHN0cmluZyxcbiAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgIGl0ZW1zOiBEYXRhSXRlbUNvbGxlY3Rpb25UeXBlLFxuICAgIGdyb3VwczogRGF0YUdyb3VwQ29sbGVjdGlvblR5cGUsXG4gICAgb3B0aW9ucz86IFRpbWVsaW5lT3B0aW9uc1xuICApOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5hbHJlYWR5RXhpc3RzRXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG5cbiAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0gPSB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBuZXcgVGltZWxpbmUoY29udGFpbmVyLCBpdGVtcywgZ3JvdXBzLCBvcHRpb25zKSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIG5ldyB2ZXJ0aWNhbCBiYXIgcmVwcmVzZW50aW5nIGEgY3VzdG9tIHRpbWUgdGhhdCBjYW4gYmUgZHJhZ2dlZCBieSB0aGUgdXNlci5cbiAgICogVGhlIGlkIGlzIGFkZGVkIGFzIENTUyBjbGFzcyBuYW1lIG9mIHRoZSBjdXN0b20gdGltZSBiYXIsXG4gICAqIGFsbG93aW5nIHRvIHN0eWxlIG11bHRpcGxlIHRpbWUgYmFycyBkaWZmZXJlbnRseS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7RGF0ZVR5cGV9IHRpbWUgUGFyYW1ldGVyIHRpbWUgY2FuIGJlIGEgRGF0ZSwgTnVtYmVyLCBvciBTdHJpbmcsIGFuZCBpcyBuZXcgRGF0ZSgpIGJ5IGRlZmF1bHQuXG4gICAqIEBwYXJhbSB7SWRUeXBlfSBbaWRdIFBhcmFtZXRlciBpZCBjYW4gYmUgTnVtYmVyIG9yIFN0cmluZyBhbmQgaXMgdW5kZWZpbmVkIGJ5IGRlZmF1bHQuXG4gICAqIEByZXR1cm5zIHtJZFR5cGV9IFRoZSBtZXRob2QgcmV0dXJucyBpZCBvZiB0aGUgY3JlYXRlZCBiYXIuXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBUaHJvd24gd2hlbiB0aW1lbGluZSBkb2VzIG5vdCBleGlzdC5cbiAgICpcbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIGFkZEN1c3RvbVRpbWUodmlzVGltZWxpbmU6IHN0cmluZywgdGltZTogRGF0ZVR5cGUsIGlkPzogSWRUeXBlKTogSWRUeXBlIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICByZXR1cm4gdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLmFkZEN1c3RvbVRpbWUodGltZSwgaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGp1c3QgdGhlIHZpc2libGUgd2luZG93IHN1Y2ggdGhhdCBpdCBmaXRzIGFsbCBpdGVtcy5cbiAgICogU2VlIGFsc28gZnVuY3Rpb24gZm9jdXMoaWQpLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHBhcmFtIHtUaW1lbGluZUFuaW1hdGlvbk9wdGlvbnN9IFtvcHRpb25zXSBPcHRpb25hbCBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBmaXQodmlzVGltZWxpbmU6IHN0cmluZywgb3B0aW9ucz86IFRpbWVsaW5lQW5pbWF0aW9uT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5maXQob3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkanVzdCB0aGUgdmlzaWJsZSB3aW5kb3cgc3VjaCB0aGF0IHRoZSBzZWxlY3RlZCBpdGVtIGlzIGNlbnRlcmVkIG9uIHNjcmVlbi5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7SWRUeXBlfSBpZCBUaGUgaWQgb2YgdGhlIGl0ZW0uXG4gICAqIEBwYXJhbSB7VGltZWxpbmVBbmltYXRpb25PcHRpb25zfSBbb3B0aW9uc10gT3B0aW9ucyBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBmb2N1c09uSWQodmlzVGltZWxpbmU6IHN0cmluZywgaWQ6IElkVHlwZSwgb3B0aW9ucz86IFRpbWVsaW5lQW5pbWF0aW9uT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5mb2N1cyhpZCwgb3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkanVzdCB0aGUgdmlzaWJsZSB3aW5kb3cgc3VjaCB0aGF0IHRoZSBzZWxlY3RlZCBpdGVtcyBhcmUgY2VudGVyZWQgb24gc2NyZWVuLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHBhcmFtIHtJZFR5cGVbXX0gaWRzIFRoZSBpdGVtIGlkcy5cbiAgICogQHBhcmFtIHtUaW1lbGluZUFuaW1hdGlvbk9wdGlvbnN9IFtvcHRpb25zXSBPcHRpb25hbCBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBmb2N1c09uSWRzKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGlkczogSWRUeXBlW10sIG9wdGlvbnM/OiBUaW1lbGluZUFuaW1hdGlvbk9wdGlvbnMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uZm9jdXMoaWRzLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHRpbWUuXG4gICAqIE9ubHkgYXBwbGljYWJsZSB3aGVuIG9wdGlvbiBzaG93Q3VycmVudFRpbWUgaXMgdHJ1ZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEByZXR1cm5zIHtEYXRlfSBUaGUgY3VycmVudCB0aW1lLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRDdXJyZW50VGltZSh2aXNUaW1lbGluZTogc3RyaW5nKTogRGF0ZSB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgcmV0dXJuIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5nZXRDdXJyZW50VGltZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgY3VzdG9tIHRpbWUgZnJvbSB0aGUgY3VzdG9tIHRpbWUgYmFyIHdpdGggZ2l2ZW4gaWQuXG4gICAqIElkIGlzIHVuZGVmaW5lZCBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHBhcmFtIHtJZFR5cGV9IFtpZF0gVGhlIHRpbWUgYmFyIGlkLlxuICAgKiBAcmV0dXJucyB7RGF0ZX0gVGhlIGN1c3RvbSB0aW1lLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRDdXN0b21UaW1lKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGlkPzogSWRUeXBlKTogRGF0ZSB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgcmV0dXJuIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5nZXRDdXN0b21UaW1lKGlkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbiBPYmplY3Qgd2l0aCByZWxldmFudCBwcm9wZXJ0aWVzIGZyb20gYW4gZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBUaGUgZXZlbnQuXG4gICAqIEByZXR1cm5zIHtWaXNUaW1lbGluZUV2ZW50UHJvcGVydGllc1Jlc3VsdH0gUHJvcGVydGllcyBvZiBhbiBldmVudFxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRFdmVudFByb3BlcnRpZXModmlzVGltZWxpbmU6IHN0cmluZywgZXZlbnQ6IEV2ZW50KTogVGltZWxpbmVFdmVudFByb3BlcnRpZXNSZXN1bHQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHJldHVybiB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uZ2V0RXZlbnRQcm9wZXJ0aWVzKGV2ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSByYW5nZSBvZiBhbGwgdGhlIGl0ZW1zIGFzIGFuIG9iamVjdCBjb250YWluaW5nIG1pbjogRGF0ZSBhbmQgbWF4OiBEYXRlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHJldHVybnMge3sgbWluOiBEYXRlLCBtYXg6IERhdGUgfX0gVGhlIG1pbiBhbmQgbWF4IGRhdGVzLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRJdGVtUmFuZ2UodmlzVGltZWxpbmU6IHN0cmluZyk6IHsgbWluOiBEYXRlOyBtYXg6IERhdGUgfSB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgcmV0dXJuIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5nZXRJdGVtUmFuZ2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFuIGFycmF5IHdpdGggdGhlIGlkcyBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGl0ZW1zLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHJldHVybnMge0lkVHlwZVtdfSBUaGUgY3VycmVudGx5IHNlbGVjdGVkIGl0ZW1zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRTZWxlY3Rpb24odmlzVGltZWxpbmU6IHN0cmluZyk6IElkVHlwZVtdIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICByZXR1cm4gdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLmdldFNlbGVjdGlvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gYXJyYXkgd2l0aCB0aGUgaWRzIG9mIHRoZSBjdXJyZW50bHkgdmlzaWJsZSBpdGVtcy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEByZXR1cm5zIHtJZFR5cGVbXX0gVGhlIGN1cnJlbnRseSB2aXNpYmxlIGl0ZW1zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRWaXNpYmxlSXRlbXModmlzVGltZWxpbmU6IHN0cmluZyk6IElkVHlwZVtdIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICByZXR1cm4gdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLmdldFZpc2libGVJdGVtcygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgdmlzaWJsZSB3aW5kb3cuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcmV0dXJucyB7eyBzdGFydDogRGF0ZSwgZW5kOiBEYXRlIH19IFJldHVybnMgYW4gb2JqZWN0IHdpdGggcHJvcGVydGllcyBzdGFydDogRGF0ZSBhbmQgZW5kOiBEYXRlLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBnZXRXaW5kb3codmlzVGltZWxpbmU6IHN0cmluZyk6IHsgc3RhcnQ6IERhdGU7IGVuZDogRGF0ZSB9IHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICByZXR1cm4gdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLmdldFdpbmRvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBcdE1vdmUgdGhlIHdpbmRvdyBzdWNoIHRoYXQgZ2l2ZW4gdGltZSBpcyBjZW50ZXJlZCBvbiBzY3JlZW4uXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0RhdGVUeXBlfSB0aW1lIFBhcmFtZXRlciB0aW1lIGNhbiBiZSBhIERhdGUsIE51bWJlciwgb3IgU3RyaW5nLlxuICAgKiBAcGFyYW0ge1RpbWVsaW5lQW5pbWF0aW9uT3B0aW9uc30gW29wdGlvbnNdIE9wdGlvbmFsIG9wdGlvbnMuXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBUaHJvd24gd2hlbiB0aW1lbGluZSBkb2VzIG5vdCBleGlzdC5cbiAgICpcbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIG1vdmVUbyh2aXNUaW1lbGluZTogc3RyaW5nLCB0aW1lOiBEYXRlVHlwZSwgb3B0aW9ucz86IFRpbWVsaW5lQW5pbWF0aW9uT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5tb3ZlVG8odGltZSwgb3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZvcmNlIGEgcmVkcmF3IG9mIHRoZSBUaW1lbGluZS5cbiAgICogVGhlIHNpemUgb2YgYWxsIGl0ZW1zIHdpbGwgYmUgcmVjYWxjdWxhdGVkLlxuICAgKiBDYW4gYmUgdXNlZnVsIHRvIG1hbnVhbGx5IHJlZHJhdyB3aGVuIG9wdGlvbiBhdXRvUmVzaXplPWZhbHNlIGFuZCB0aGUgd2luZG93IGhhcyBiZWVuIHJlc2l6ZWQsXG4gICAqIG9yIHdoZW4gdGhlIGl0ZW1zIENTUyBoYXMgYmVlbiBjaGFuZ2VkLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93biB3aGVuIHRpbWVsaW5lIGRvZXMgbm90IGV4aXN0LlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgcmVkcmF3KHZpc1RpbWVsaW5lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0ucmVkcmF3KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB2ZXJ0aWNhbCBiYXJzIHByZXZpb3VzbHkgYWRkZWQgdG8gdGhlIHRpbWVsaW5lIHZpYSBhZGRDdXN0b21UaW1lIG1ldGhvZC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7SWRUeXBlfSBpZCBQYXJhbWV0ZXIgaWQgaXMgdGhlIElEIG9mIHRoZSBjdXN0b20gdmVydGljYWwgYmFyIHJldHVybmVkIGJ5IGFkZEN1c3RvbVRpbWUgbWV0aG9kLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyByZW1vdmVDdXN0b21UaW1lKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGlkOiBJZFR5cGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0ucmVtb3ZlQ3VzdG9tVGltZShpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBhIGN1cnJlbnQgdGltZS5cbiAgICogVGhpcyBjYW4gYmUgdXNlZCBmb3IgZXhhbXBsZSB0byBlbnN1cmUgdGhhdCBhIGNsaWVudCdzIHRpbWUgaXMgc3luY2hyb25pemVkXG4gICAqIHdpdGggYSBzaGFyZWQgc2VydmVyIHRpbWUuXG4gICAqIE9ubHkgYXBwbGljYWJsZSB3aGVuIG9wdGlvbiBzaG93Q3VycmVudFRpbWUgaXMgdHJ1ZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7RGF0ZVR5cGV9IHRpbWUgdGltZSBjYW4gYmUgYSBEYXRlIG9iamVjdCwgbnVtZXJpYyB0aW1lc3RhbXAsIG9yIElTTyBkYXRlIHN0cmluZy5cbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93biB3aGVuIHRpbWVsaW5lIGRvZXMgbm90IGV4aXN0LlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgc2V0Q3VycmVudFRpbWUodmlzVGltZWxpbmU6IHN0cmluZywgdGltZTogRGF0ZVR5cGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uc2V0Q3VycmVudFRpbWUodGltZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFx0QWRqdXN0IHRoZSB0aW1lIG9mIGEgY3VzdG9tIHRpbWUgYmFyLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmlzVGltZWxpbmUgVGhlIHRpbWVsaW5lIG5hbWUvaWRlbnRpZmllci5cbiAgICogQHBhcmFtIHtEYXRlVHlwZX0gdGltZSBQYXJhbWV0ZXIgdGltZSBjYW4gYmUgYSBEYXRlIG9iamVjdCwgbnVtZXJpYyB0aW1lc3RhbXAsIG9yIElTTyBkYXRlIHN0cmluZy5cbiAgICogQHBhcmFtIHtJZFR5cGV9IFtpZF0gUGFyYW1ldGVyIGlkIGlzIHRoZSBpZCBvZiB0aGUgY3VzdG9tIHRpbWUgYmFyLCBhbmQgaXMgdW5kZWZpbmVkIGJ5IGRlZmF1bHQuXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBUaHJvd24gd2hlbiB0aW1lbGluZSBkb2VzIG5vdCBleGlzdC5cbiAgICpcbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIHNldEN1c3RvbVRpbWUodmlzVGltZWxpbmU6IHN0cmluZywgdGltZTogRGF0ZVR5cGUsIGlkPzogSWRUeXBlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLnNldEN1c3RvbVRpbWUodGltZSwgaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGp1c3QgdGhlIHRpdGxlIGF0dHJpYnV0ZSBvZiBhIGN1c3RvbSB0aW1lIGJhci5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZSBQYXJhbWV0ZXIgdGl0bGUgaXMgdGhlIHN0cmluZyB0byBiZSBzZXQgYXMgdGl0bGUuXG4gICAqICAgICAgICAgICAgICAgICAgICAgICBVc2UgZW1wdHkgc3RyaW5nIHRvIGhpZGUgdGhlIHRpdGxlIGNvbXBsZXRlbHkuXG4gICAqIEBwYXJhbSB7SWRUeXBlfSBbaWRdIFBhcmFtZXRlciBpZCBpcyB0aGUgaWQgb2YgdGhlIGN1c3RvbSB0aW1lIGJhciwgYW5kIGlzIHVuZGVmaW5lZCBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBzZXRDdXN0b21UaW1lVGl0bGUodmlzVGltZWxpbmU6IHN0cmluZywgdGl0bGU6IHN0cmluZywgaWQ/OiBJZFR5cGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uc2V0Q3VzdG9tVGltZVRpdGxlKHRpdGxlLCBpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBib3RoIGdyb3VwcyBhbmQgaXRlbXMgYXQgb25jZS5cbiAgICogQm90aCBwcm9wZXJ0aWVzIGFyZSBvcHRpb25hbC5cbiAgICogVGhpcyBpcyBhIGNvbnZlbmllbmNlIG1ldGhvZCBmb3IgaW5kaXZpZHVhbGx5IGNhbGxpbmcgYm90aCBzZXRJdGVtcyhpdGVtcykgYW5kIHNldEdyb3Vwcyhncm91cHMpLlxuICAgKiBCb3RoIGl0ZW1zIGFuZCBncm91cHMgY2FuIGJlIGFuIEFycmF5IHdpdGggT2JqZWN0cywgYSBEYXRhU2V0IChvZmZlcmluZyAyIHdheSBkYXRhIGJpbmRpbmcpLFxuICAgKiBvciBhIERhdGFWaWV3IChvZmZlcmluZyAxIHdheSBkYXRhIGJpbmRpbmcpLlxuICAgKiBGb3IgZWFjaCBvZiB0aGUgZ3JvdXBzLCB0aGUgaXRlbXMgb2YgdGhlIHRpbWVsaW5lIGFyZSBmaWx0ZXJlZCBvbiB0aGUgcHJvcGVydHkgZ3JvdXAsXG4gICAqIHdoaWNoIG11c3QgY29ycmVzcG9uZCB3aXRoIHRoZSBpZCBvZiB0aGUgZ3JvdXAuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge3sgZ3JvdXBzPzogVmlzVGltZWxpbmVHcm91cHM7IGl0ZW1zPzogVmlzVGltZWxpbmVJdGVtcyB9fSBkYXRhIFRoZSBuZXcgdGltbGluZSBkYXRhLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBzZXREYXRhKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGRhdGE6IHsgZ3JvdXBzPzogRGF0YUdyb3VwQ29sbGVjdGlvblR5cGU7IGl0ZW1zPzogRGF0YUl0ZW1Db2xsZWN0aW9uVHlwZSB9KTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLnNldERhdGEoZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBhIGRhdGEgc2V0IHdpdGggZ3JvdXBzIGZvciB0aGUgVGltZWxpbmUuXG4gICAqIEZvciBlYWNoIG9mIHRoZSBncm91cHMsIHRoZSBpdGVtcyBvZiB0aGUgdGltZWxpbmUgYXJlIGZpbHRlcmVkIG9uIHRoZSBwcm9wZXJ0eSBncm91cCxcbiAgICogd2hpY2ggbXVzdCBjb3JyZXNwb25kIHdpdGggdGhlIGlkIG9mIHRoZSBncm91cC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7VmlzVGltZWxpbmVHcm91cHN9IGdyb3VwcyBhIERhdGFTZXQgKG9mZmVyaW5nIDIgd2F5IGRhdGEgYmluZGluZylcbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93biB3aGVuIHRpbWVsaW5lIGRvZXMgbm90IGV4aXN0LlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgc2V0R3JvdXBzKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGdyb3VwczogRGF0YUdyb3VwQ29sbGVjdGlvblR5cGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uc2V0R3JvdXBzKGdyb3Vwcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmRvZXNOb3RFeGlzdEVycm9yKHZpc1RpbWVsaW5lKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBhIGRhdGEgc2V0IHdpdGggaXRlbXMgZm9yIHRoZSBUaW1lbGluZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7VmlzVGltZWxpbmVJdGVtc30gaXRlbXMgY2FuIGJlIGFuIEFycmF5IHdpdGggT2JqZWN0cywgYSBEYXRhU2V0IChvZmZlcmluZyAyIHdheSBkYXRhIGJpbmRpbmcpXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBUaHJvd24gd2hlbiB0aW1lbGluZSBkb2VzIG5vdCBleGlzdC5cbiAgICpcbiAgICogQG1lbWJlck9mIFZpc1RpbWVsaW5lU2VydmljZVxuICAgKi9cbiAgcHVibGljIHNldEl0ZW1zKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGl0ZW1zOiBEYXRhSXRlbUNvbGxlY3Rpb25UeXBlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLnNldEl0ZW1zKGl0ZW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IG9yIHVwZGF0ZSBvcHRpb25zLlxuICAgKiBJdCBpcyBwb3NzaWJsZSB0byBjaGFuZ2UgYW55IG9wdGlvbiBvZiB0aGUgdGltZWxpbmUgYXQgYW55IHRpbWUuXG4gICAqIFlvdSBjYW4gZm9yIGV4YW1wbGUgc3dpdGNoIG9yaWVudGF0aW9uIG9uIHRoZSBmbHkuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge1Zpc1RpbWVsaW5lT3B0aW9uc30gb3B0aW9ucyBUaGUgbmV3IG9wdGlvbnMgb2YgdGhlIHRpbWVsaW5lLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBzZXRPcHRpb25zKHZpc1RpbWVsaW5lOiBzdHJpbmcsIG9wdGlvbnM6IFRpbWVsaW5lT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5zZXRPcHRpb25zKG9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5kb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3Qgb25lIGl0ZW0gYnkgaXRzIGlkLiNcbiAgICogVGhlIGN1cnJlbnRseSBzZWxlY3RlZCBpdGVtcyB3aWxsIGJlIHVuc2VsZWN0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0lkVHlwZX0gaWQgVGhlIGlkIG9mIHRoZSBpdGVtIHRoYXQgc2hvdWxkIGJlIHNlbGVjdGVkLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBzZXRTZWxlY3Rpb25Ub0lkKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGlkOiBJZFR5cGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdKSB7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0uc2V0U2VsZWN0aW9uKGlkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IG11bHRpcGxlIGl0ZW1zIGJ5IHRoZWlyIGlkLlxuICAgKiBUaGUgY3VycmVudGx5IHNlbGVjdGVkIGl0ZW1zIHdpbGwgYmUgdW5zZWxlY3RlZC5cbiAgICogVG8gdW5zZWxlY3QgYWxsIHNlbGVjdGVkIGl0ZW1zLCBjYWxsIGBzZXRTZWxlY3Rpb24oW10pYC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7SWRUeXBlW119IGlkcyBUaGUgaWRzIG9mIHRoZSBpcmVtcyB0aGF0IHNob3VsZCBiZSBzZWxlY3RlZC5cbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93biB3aGVuIHRpbWVsaW5lIGRvZXMgbm90IGV4aXN0LlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgc2V0U2VsZWN0aW9uVG9JZHModmlzVGltZWxpbmU6IHN0cmluZywgaWRzOiBJZFR5cGVbXSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0pIHtcbiAgICAgIHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXS5zZXRTZWxlY3Rpb24oaWRzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBjdXJyZW50IHZpc2libGUgd2luZG93LlxuICAgKlxuICAgKiBJZiB0aGUgcGFyYW1ldGVyIHZhbHVlIG9mIHN0YXJ0IG9yIGVuZCBpcyBudWxsLCB0aGUgcGFyYW1ldGVyIHdpbGwgYmUgbGVmdCB1bmNoYW5nZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge0RhdGVUeXBlfSBzdGFydCBUaGUgcGFyYW1ldGVycyBzdGFydCBjYW4gYmUgYSBEYXRlLCBOdW1iZXIsIG9yIFN0cmluZy5cbiAgICogQHBhcmFtIHtEYXRlVHlwZX0gZW5kIFRoZSBwYXJhbWV0ZXJzIGVuZCBjYW4gYmUgYSBEYXRlLCBOdW1iZXIsIG9yIFN0cmluZy5cbiAgICogQHBhcmFtIHtUaW1lbGluZUFuaW1hdGlvbk9wdGlvbnN9IFtvcHRpb25zXSBPcHRpb25hbCBvcHRpb25zLlxuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3duIHdoZW4gdGltZWxpbmUgZG9lcyBub3QgZXhpc3QuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBzZXRXaW5kb3codmlzVGltZWxpbmU6IHN0cmluZywgc3RhcnQ6IERhdGVUeXBlLCBlbmQ6IERhdGVUeXBlLCBvcHRpb25zPzogVGltZWxpbmVBbmltYXRpb25PcHRpb25zKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLnNldFdpbmRvdyhzdGFydCwgZW5kLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZG9lc05vdEV4aXN0RXJyb3IodmlzVGltZWxpbmUpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveSB0aGUgVGltZWxpbmUuXG4gICAqIFRoZSB0aW1lbGluZSBpcyByZW1vdmVkIGZyb20gbWVtb3J5LlxuICAgKiBBbGwgRE9NIGVsZW1lbnRzIGFuZCBldmVudCBsaXN0ZW5lcnMgYXJlIGNsZWFuZWQgdXAuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgZGVzdHJveSh2aXNUaW1lbGluZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLmRlc3Ryb3koKTtcbiAgICAgIGRlbGV0ZSB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFjdGl2YXRlcyBhbiBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZpc1RpbWVsaW5lIFRoZSB0aW1lbGluZSBuYW1lL2lkZW50aWZpZXIuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWUgVGhlIGV2ZW50IG5hbWUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcHJldmVudERlZmF1bHQgU3RvcHMgdGhlIGRlZmF1bHQgYmVoYXZpb3Igb2YgdGhlIGV2ZW50LlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIHdoZW4gdGhlIGV2ZW50IHdhcyBhY3RpdmF0ZWQuXG4gICAqXG4gICAqIEBtZW1iZXJPZiBWaXNUaW1lbGluZVNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBvbih2aXNUaW1lbGluZTogc3RyaW5nLCBldmVudE5hbWU6IHN0cmluZywgcHJldmVudERlZmF1bHQ/OiBib29sZWFuKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy5ldmVudHMuc2V0KGV2ZW50TmFtZSwgbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCkpO1xuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG4gICAgICBjb25zdCB0aGF0OiB7IFtpbmRleDogc3RyaW5nXTogYW55IH0gPSB0aGlzO1xuICAgICAgdGhpcy50aW1lbGluZXNbdmlzVGltZWxpbmVdLm9uKGV2ZW50TmFtZSwgKHBhcmFtczogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IGVtaXR0ZXIgPSAodGhhdFtldmVudE5hbWVdIHx8IHRoYXQuZXZlbnRzLmdldChldmVudE5hbWUpKSBhcyBFdmVudEVtaXR0ZXI8YW55PjtcbiAgICAgICAgaWYgKGVtaXR0ZXIpIHtcbiAgICAgICAgICBlbWl0dGVyLmVtaXQocGFyYW1zID8gW3Zpc1RpbWVsaW5lXS5jb25jYXQocGFyYW1zKSA6IHZpc1RpbWVsaW5lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJldmVudERlZmF1bHQgJiYgcGFyYW1zLmV2ZW50KSB7XG4gICAgICAgICAgcGFyYW1zLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogRGVhY3RpdmF0ZXMgYW4gZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2aXNUaW1lbGluZSBUaGUgdGltZWxpbmUgbmFtZS9pZGVudGlmaWVyLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lIFRoZSBldmVudCBuYW1lLlxuICAgKlxuICAgKiBAbWVtYmVyT2YgVmlzVGltZWxpbmVTZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgb2ZmKHZpc1RpbWVsaW5lOiBzdHJpbmcsIGV2ZW50TmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudGltZWxpbmVzW3Zpc1RpbWVsaW5lXSkge1xuICAgICAgdGhpcy5ldmVudHMuZGVsZXRlKGV2ZW50TmFtZSk7XG4gICAgICB0aGlzLnRpbWVsaW5lc1t2aXNUaW1lbGluZV0ub2ZmKGV2ZW50TmFtZSwgdW5kZWZpbmVkKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBldmVudCBlbWl0dGVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGV2ZW50IG5hbWUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWUgVGhlIGV2ZW50IG5hbWUuXG4gICAqIEByZXR1cm5zIHtFdmVudEVtaXR0ZXI8YW55Pn0gVGhlIGV2ZW50IGVtaXR0ZXIgb2YgdGhlIHNwZWNpZmllZCBldmVudCBuYW1lLlxuICAgKi9cbiAgcHVibGljIGdldEVtaXR0ZXIoZXZlbnROYW1lOiBzdHJpbmcpOiBFdmVudEVtaXR0ZXI8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRzLmdldChldmVudE5hbWUpO1xuICB9XG5cbiAgcHJpdmF0ZSBkb2VzTm90RXhpc3RFcnJvcih2aXNUaW1lbGluZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFRpbWVsaW5lIHdpdGggaWQgJHt2aXNUaW1lbGluZX0gZG9lcyBub3QgZXhpc3QuYDtcbiAgfVxuXG4gIHByaXZhdGUgYWxyZWFkeUV4aXN0c0Vycm9yKHZpc1RpbWVsaW5lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgVGltZWxpbmUgd2l0aCBpZCAke3Zpc1RpbWVsaW5lfSBhbHJlYWR5IGV4aXN0cy5gO1xuICB9XG59XG4iXX0=