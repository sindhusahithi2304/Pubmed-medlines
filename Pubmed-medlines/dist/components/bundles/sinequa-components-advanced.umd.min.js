!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@sinequa/core/base"),require("@sinequa/core/app-utils"),require("@sinequa/components/search"),require("@sinequa/core/validation"),require("@sinequa/core/intl"),require("@sinequa/components/autocomplete"),require("@sinequa/components/utils"),require("@angular/common"),require("moment"),require("ngx-bootstrap/datepicker")):"function"==typeof define&&define.amd?define("@sinequa/components/advanced",["exports","@angular/core","@angular/forms","@sinequa/core/base","@sinequa/core/app-utils","@sinequa/components/search","@sinequa/core/validation","@sinequa/core/intl","@sinequa/components/autocomplete","@sinequa/components/utils","@angular/common","moment","ngx-bootstrap/datepicker"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).sinequa=e.sinequa||{},e.sinequa.components=e.sinequa.components||{},e.sinequa.components.advanced={}),e.ng.core,e.ng.forms,e.sinequa.core.base,e.sinequa.core["app-utils"],e.sinequa.components.search,e.sinequa.core.validation,e.sinequa.core.intl,e.sinequa.components.autocomplete,e.sinequa.components.utils,e.ng.common,e.moment,e["ngx-bootstrap"].datepicker)}(this,(function(e,t,n,i,o,r,a,s,l,u,c,p,d){"use strict";function m(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=m(p),h=function(){function e(e,t,i,o,r){var a=this;this.appService=e,this.searchService=t,this.validationService=i,this.formatService=o,this.exprBuilder=r,this.validators={min:function(e,t){return a.validationService.minValidator(e,a._parser(t))},max:function(e,t){return a.validationService.maxValidator(e,a._parser(t))},required:n.Validators.required,email:n.Validators.email,pattern:function(e){return n.Validators.pattern(e)},integer:function(e){return a.validationService.integerValidator(a._parser(e))},number:function(e){return a.validationService.numberValidator(a._parser(e))},date:function(e){return a.validationService.dateValidator(a._parser(e))},range:function(e){return a.validationService.rangeValidator(a._rangeType(e),a._parser(e))}}}return e.prototype.createSelectControl=function(e,t,n,i){void 0===i&&(i=this.searchService.query);var o=this.getValue(e,i);return this.createControl(o,t,n)},e.prototype.createRangeControl=function(e,t,n,i){void 0===i&&(i=this.searchService.query);var o=this.getRangeValue(e,i);return this.createControl(o,t,n)},e.prototype.createInputControl=function(e,t,n,i){void 0===i&&(i=this.searchService.query);var o=this.getValue(e,i);return this.createControl(o,t,n)},e.prototype.createMultiInputControl=function(e,t,n,i){void 0===i&&(i=this.searchService.query);var o=this.getValue(e,i);return this.createControl(o,t,n)},e.prototype.createCheckboxControl=function(e,t,n,i){void 0===i&&(i=this.searchService.query);var o=this.getBooleanValue(e,i);return this.createControl(o,t,n)},e.prototype.resetControl=function(e){e.reset(),e.setValue(void 0)},e.prototype.resetRangeControl=function(e){e.reset(),e.setValue([void 0,void 0])},e.prototype.getValue=function(e,t){void 0===t&&(t=this.searchService.query);var n=this.getAdvancedExpr(e,t);if(n){var i=this.getValueFromExpr(n);return this.formatValueItems(e,i)}},e.prototype.getBooleanValue=function(e,t){void 0===t&&(t=this.searchService.query);var n=this.getAdvancedExpr(e,t);if(n){var i=this.getValueFromExpr(n);return this.formatAdvancedValue(e,i.value)}},e.prototype.getRangeValue=function(e,t){var n=this;void 0===t&&(t=this.searchService.query);var o=this.getAdvancedExpr(e,t);if(o){var r=this.getValueFromExpr(o);if(i.Utils.isArray(r))return r.map((function(t){return n.formatAdvancedValue(e,t.value)}));var a=this.formatAdvancedValue(e,r.value);if(3===o.operator)return[a,void 0];if(5===o.operator)return[void 0,a]}return[void 0,void 0]},e.prototype.getAdvancedExpr=function(e,t){var n,i;void 0===t&&(t=this.searchService.query);var r=null===(n=t.findSelect(o.advancedFacetPrefix+e))||void 0===n?void 0:n.expression;if(r&&(i=this.appService.parseExpr(r))instanceof o.Expr)return i},e.prototype.getValueFromExpr=function(e){var t,n;return i.Utils.isString(e.value)&&e.value.indexOf("[")>-1?n=JSON.parse(e.value.replace(/`/g,'"')).map((function(e){return{value:e.value,display:e.display?e.display:e.value}})):(null===(t=e.operands)||void 0===t?void 0:t.length)>0&&(n=e.operands.map((function(e){return{value:e.value,display:e.display?e.display:e.value}}))),n||(n=e.values&&e.values.length>1?e.values.map((function(e){return{value:e,display:e}})):{value:e.value,display:e.display?e.display:e.value}),n},e.prototype.setSelect=function(e,t,n,i){var o;if(void 0!==t){var r=this.asValueItems(t,e);o=i?this.exprBuilder.makeAndExpr(e,r):this.exprBuilder.makeOrExpr(e,r)}this.setAdvancedSelect(e,o,n)},e.prototype.setBooleanSelect=function(e,t,n,i){var o;void 0===n&&(n=!1),(!0===t||!1===t&&n)&&(o=this.exprBuilder.makeBooleanExpr(e,t)),this.setAdvancedSelect(e,o,i)},e.prototype.setNumericalSelect=function(e,t,n,i){var o;void 0!==t&&(this._isValueItem(t)&&(t=t.value),t=this.parse(t,e),o=this.exprBuilder.makeNumericalExpr(e,n,t)),this.setAdvancedSelect(e,o,i)},e.prototype.setRangeSelect=function(e,t,n){var i;if(t&&2===t.length){var o=this.parse(t[0]||void 0,e),r=this.parse(t[1]||void 0,e);o&&r?i=this.exprBuilder.makeRangeExpr(e,o,r):o?i=this.exprBuilder.makeNumericalExpr(e,">=",o):r&&(i=this.exprBuilder.makeNumericalExpr(e,"<=",r))}this.setAdvancedSelect(e,i,n)},e.prototype.setAdvancedSelect=function(e,t,n){void 0===n&&(n=this.searchService.query),n.removeSelect(o.advancedFacetPrefix+e),t&&n.addSelect(t,o.advancedFacetPrefix+e)},e.prototype.removeAdvancedValue=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=this.searchService.query),e&&(n.removeSelect(o.advancedFacetPrefix+e),this.searchService.setQuery(n,!1),t&&this.searchService.search())},e.prototype.resetAdvancedValues=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=this.searchService.query),this.searchService.setQuery(t.toStandard(),!1),e&&this.searchService.search()},e.prototype.asValueItems=function(e,t){var n=this;return this._isValueItemArray(e)?e.map((function(e){return{value:n.parse(e.value,t),display:e.display}})):[{value:this.parse(e.value,t),display:e.display}]},e.prototype.formatValueItems=function(e,t){var n=this;return this._isValueItemArray(t)?t.map((function(t){return n.formatValueItem(e,t)})):this.formatValueItem(e,t)},e.prototype.formatValueItem=function(e,t){var n=this.appService.getColumn(e);return n&&(t.display=this.formatBaseAdvancedValue(t.display,n).toString()),t},e.prototype.formatAdvancedValue=function(e,t){var n=this;if(t){var o=this.appService.getColumn(e);if(o)return i.Utils.isArray(t)?t.map((function(e){return e?n.formatBaseAdvancedValue(e,o):e})):this.formatBaseAdvancedValue(t,o)}return t},e.prototype.formatBaseAdvancedValue=function(e,t){return e?(e=this.castAdvancedValue(e,t),t.formatter?this.formatService.formatValue(e,t):e):e},e.prototype.castAdvancedValue=function(e,t){return t&&i.Utils.isString(e)&&(o.AppService.isDate(t)?e=i.Utils.toDate(e):o.AppService.isInteger(t)?i.Utils.testInteger(e)&&(e=i.Utils.toInt(e)):o.AppService.isDouble(t)?i.Utils.testFloat(e)&&(e=i.Utils.toNumber(e)):o.AppService.isBoolean(t)&&(e=i.Utils.isTrue(e))),e},e.prototype.createControl=function(e,t,i){return new n.FormControl({value:e,disabled:!1},{validators:t||[],asyncValidators:i||[],updateOn:"change"})},e.prototype.parse=function(e,t){var n=this._parser(t);return n&&i.Utils.isString(e)?this.formatService.parseValue(e,n):e},e.prototype._parser=function(e){var t=this.appService.getColumn(e);return t?t.parser:void 0},e.prototype._rangeType=function(e){var t=this.appService.getColumn(e);return t&&(o.AppService.isInteger(t)||o.AppService.isDouble(t))?0:t&&o.AppService.isDate(t)?new Date:""},e.prototype._isValueItemArray=function(e){var t=this;if(i.Utils.isArray(e)){return e.every((function(e){return t._isValueItem(e)}))}return!1},e.prototype._isValueItem=function(e){return!(!i.Utils.isObject(e)||i.Utils.isArray(e)||i.Utils.isDate(e)||!e.hasOwnProperty("value"))},e}();h.ɵfac=function(e){return new(e||h)(t.ɵɵinject(o.AppService),t.ɵɵinject(r.SearchService),t.ɵɵinject(a.ValidationService),t.ɵɵinject(o.FormatService),t.ɵɵinject(o.ExprBuilder))},h.ɵprov=t.ɵɵdefineInjectable({token:h,factory:h.ɵfac,providedIn:"root"});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function g(e,t){function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}Object.create;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.prototype.ngOnInit=function(){this.options={form:this.validationForm,controlName:this.field},e.prototype.ngOnInit.call(this)},t}(a.ValidationDirective);b.ɵfac=function(e){return C(e||b)},b.ɵdir=t.ɵɵdefineDirective({type:b,selectors:[["","sqAdvancedFormValidation",""]],inputs:{field:"field",validationForm:"validationForm"},features:[t.ɵɵInheritDefinitionFeature]});var C=t.ɵɵgetInheritedFactory(b),I=function(){function e(e){this.appService=e}return e.prototype.ngOnChanges=function(){void 0===this.label&&(this.label=this.appService.getLabel(this.field))},e}();I.ɵfac=function(e){return new(e||I)(t.ɵɵdirectiveInject(o.AppService))},I.ɵcmp=t.ɵɵdefineComponent({type:I,selectors:[["sq-advanced-form-checkbox"]],inputs:{form:"form",field:"field",label:"label"},features:[t.ɵɵNgOnChangesFeature],decls:7,vars:7,consts:[[1,"form-group",3,"formGroup"],[1,"form-check"],[1,"custom-control","custom-checkbox"],["type","checkbox","sqAdvancedFormValidation","",1,"custom-control-input",3,"field","validationForm","formControlName"],[1,"custom-control-label"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵelementStart(2,"label",2),t.ɵɵelement(3,"input",3),t.ɵɵelementStart(4,"span",4),t.ɵɵtext(5),t.ɵɵpipe(6,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("formGroup",n.form),t.ɵɵadvance(3),t.ɵɵproperty("field",n.field)("validationForm",n.form)("formControlName",n.field),t.ɵɵadvance(2),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(6,5,n.label)))},directives:[n.NgControlStatusGroup,n.FormGroupDirective,n.CheckboxControlValueAccessor,b,n.NgControlStatus,n.FormControlName],pipes:[s.MessagePipe],encapsulation:2});var x=function(e){function n(n,i,o,r){var a=e.call(this,n,i,o,r)||this;return a.UpdateItem=new t.EventEmitter,a}return g(n,e),n.prototype.ngOnInit=function(){var e=this;this._dropdownSubscription=this.dropdown.clicked.subscribe((function(t){e.select(t,!1)})),this.start()},n.prototype.getSuggests=function(){var e=this.getInputValue();e?this.processSuggests(this.getSuggestsObs(e,[this.field])):this.start()},n.prototype.processSuggests=function(e){var t=this;e.subscribe((function(e){t.getState()!==l.AutocompleteState.ACTIVE&&t.getState()!==l.AutocompleteState.OPENED||t.dropdown.update(!0,e.filter((function(e){return"$field$"!==e.category})).map((function(e){return e.label||(e.label=t.appService.getLabel(e.category)),e.normalized||(e.normalized=e.display),e})))}),(function(e){t.dropdown.update(!1)}),(function(){t.dropdown.hasItems&&t.getState()===l.AutocompleteState.ACTIVE?t.open():t.dropdown.hasItems||t.getState()!==l.AutocompleteState.OPENED||t.active()}))},n.prototype.setAutocompleteItem=function(e){return!!e&&(this.setInputValue(e.display),this.UpdateItem.next(Object.assign(Object.assign({},e),{normalized:e.normalized?e.normalized:e.display})),!0)},n.prototype.blur=function(e){if(this.getState()!==l.AutocompleteState.SELECTED)if(this.getInputValue()&&""!==this.getInputValue()){var t={display:this.getInputValue(),normalized:this.getInputValue(),category:""};this.setAutocompleteItem(t)}else this.UpdateItem.next(void 0);this.init()},n.prototype.inputChanged=function(e){switch(this.getState()){case l.AutocompleteState.OPENED:this.suggest();break;case l.AutocompleteState.START:case l.AutocompleteState.ACTIVE:this.active();break;case l.AutocompleteState.SELECTED:this.start(),this.active();break;case l.AutocompleteState.INIT:}},n}(l.Autocomplete);function w(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",6),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=n.$implicit;t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.display)}}x.ɵfac=function(e){return new(e||x)(t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(l.SuggestService),t.ɵɵdirectiveInject(o.AppService),t.ɵɵdirectiveInject(u.UIService))},x.ɵdir=t.ɵɵdefineDirective({type:x,selectors:[["","sqAdvancedFormAutocomplete",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("blur",(function(e){return n.blur(e)}))("input",(function(e){return n.inputChanged(e)}))},inputs:{field:"field"},outputs:{UpdateItem:"UpdateItem"},features:[t.ɵɵInheritDefinitionFeature]});var k=function(){function e(e){this.appService=e}return e.prototype.ngOnChanges=function(){var e=this;if(void 0===this.label&&(this.label=this.appService.getLabel(this.field)),this.control=this.form.get(this.field),!this.control)throw new Error("No form control named "+this.field);this.control.value&&(this.viewValue=this.control.value.display?this.control.value.display:this.control.value.value.toString()),this._valueChangesSubscription=i.Utils.subscribe(this.control.valueChanges,(function(t){t&&(e.viewValue=t.display?t.display:t.value.toString())}))},e.prototype.ngOnDestroy=function(){this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe()},e.prototype.onItemChange=function(e){this.viewValue=null==e?void 0:e.display,this._updateControl(e)},e.prototype._updateControl=function(e){var t,n,i=e?{value:e.normalized,display:e.display}:void 0;null===(t=this.control)||void 0===t||t.markAsDirty(),null===(n=this.control)||void 0===n||n.setValue(i,{emitEvent:!1})},e}();k.ɵfac=function(e){return new(e||k)(t.ɵɵdirectiveInject(o.AppService))},k.ɵcmp=t.ɵɵdefineComponent({type:k,selectors:[["sq-advanced-form-input"]],inputs:{form:"form",field:"field",suggestQuery:"suggestQuery",label:"label"},features:[t.ɵɵNgOnChangesFeature],decls:10,vars:11,consts:[[1,"form-group"],[3,"for"],[1,"d-flex","flex-column"],["sqAdvancedFormAutocomplete","","sqAdvancedFormValidation","","type","text","autocomplete","off","spellcheck","off",1,"form-control",3,"off","suggestQuery","dropdown","validationForm","field","id","ngModel","ngModelChange","UpdateItem"],["dropdown",""],["itemTpl",""],[1,"py-2"]],template:function(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"label",1),t.ɵɵtext(2),t.ɵɵpipe(3,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",2),t.ɵɵelementStart(5,"input",3),t.ɵɵlistener("ngModelChange",(function(e){return n.viewValue=e}))("UpdateItem",(function(e){return n.onItemChange(e)})),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"sq-autocomplete-list",null,4),t.ɵɵtemplate(8,w,2,1,"ng-template",null,5,t.ɵɵtemplateRefExtractor),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e){var i=t.ɵɵreference(7);t.ɵɵadvance(1),t.ɵɵpropertyInterpolate("for",n.field),t.ɵɵadvance(1),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(3,9,n.label)),t.ɵɵadvance(3),t.ɵɵproperty("off",!n.suggestQuery)("suggestQuery",n.suggestQuery)("dropdown",i)("validationForm",n.form)("field",n.field)("id",n.field)("ngModel",n.viewValue)}},directives:[n.DefaultValueAccessor,x,b,n.NgControlStatus,n.NgModel,l.BsAutocompleteList],pipes:[s.MessagePipe],encapsulation:2});var A=function(e){function n(){var n=e.apply(this,S(arguments))||this;return n.itemsUpdate=new t.EventEmitter,n.items=[],n}return g(n,e),n.prototype.setAutocompleteItem=function(e){return e&&(this.items.push(e),this.itemsUpdate.next(this.items),this.setInputValue("")),!1},n.prototype.keydown=function(t){var n=e.prototype.keydown.call(this,t);return void 0===n&&(t.keyCode===i.Keys.backspace&&""===this.getInputValue()&&(this.items.pop(),this.itemsUpdate.next(this.items)),t.keyCode===i.Keys.enter&&this._manageSetAutocompleteItem()),n},n.prototype.blur=function(e){this._manageSetAutocompleteItem(),this.init()},n.prototype._manageSetAutocompleteItem=function(){this.getInputValue()&&""!==this.getInputValue()&&this.setAutocompleteItem({display:this.getInputValue(),normalized:this.getInputValue(),category:""})},n}(x);A.ɵfac=function(e){return D(e||A)},A.ɵdir=t.ɵɵdefineDirective({type:A,selectors:[["","sqAdvancedFormAutocompleteMultiInput",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("blur",(function(e){return n.blur(e)}))},inputs:{items:"items"},outputs:{itemsUpdate:"itemsUpdate"},features:[t.ɵɵInheritDefinitionFeature]});var D=t.ɵɵgetInheritedFactory(A);function V(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"span",7),t.ɵɵtext(1),t.ɵɵelementStart(2,"span",8),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().removeItem(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=n.$implicit;t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",o.display," ")}}function E(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",9),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=n.$implicit;t.ɵɵadvance(1),t.ɵɵtextInterpolate1("",i.display," ")}}var F=function(){function e(e,t){this.elementRef=e,this.appService=t,this.items=[]}return e.prototype.ngOnChanges=function(){var e=this;if(void 0===this.label&&(this.label=this.appService.getPluralLabel(this.field)),this.control=this.form.get(this.field),!this.control)throw new Error("No form control named "+this.field);this.items=this.control.value?(i.Utils.isArray(this.control.value)?this.control.value:[this.control.value]).map((function(e){return{display:e.display?e.display:e.value.toString(),normalized:e.value.toString(),category:""}})):[],this._valueChangesSubscription=i.Utils.subscribe(this.control.valueChanges,(function(t){t&&!i.Utils.isArray(t)&&(t=[t]),e.items=t?t.map((function(e){return{display:e.display?e.display:e.value.toString(),normalized:e.value.toString(),category:""}})):[]}))},e.prototype.ngOnDestroy=function(){this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe()},e.prototype.removeItem=function(e){this.items.splice(this.items.indexOf(e),1),this._updateControl()},e.prototype.onItemsChanged=function(e){this.items=e,this._updateControl()},e.prototype.keydown=function(e){if(e.keyCode===i.Keys.tab){var t=this._getDropdownItem();if(t)return t.focus(),e.preventDefault(),!1}},e.prototype.keypress=function(e){if(e.keyCode===i.Keys.enter)return e.preventDefault(),!1},e.prototype._updateControl=function(){var e,t,n=this.items.length>0?this.items.map((function(e){return{value:e.normalized,display:e.display}})):void 0;null===(e=this.control)||void 0===e||e.markAsDirty(),null===(t=this.control)||void 0===t||t.setValue(n,{emitEvent:!1})},e.prototype._getDropdownItem=function(){if(this.elementRef){for(var e=this.elementRef.nativeElement;e&&!e.classList.contains("dropdown-item");)e=e.parentElement;return e}return null},e}();F.ɵfac=function(e){return new(e||F)(t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(o.AppService))},F.ɵcmp=t.ɵɵdefineComponent({type:F,selectors:[["sq-advanced-form-multi-input"]],inputs:{form:"form",field:"field",suggestQuery:"suggestQuery",label:"label"},features:[t.ɵɵNgOnChangesFeature],decls:12,vars:11,consts:[[1,"d-inline"],[1,"sq-dropdown-form"],["sqAdvancedFormValidation","",1,"form-control","multi-entry",3,"field","validationForm"],["class","badge badge-pill badge-secondary align-self-center mr-1",4,"ngFor","ngForOf"],["type","text","autocomplete","off","spellcheck","off","sqAdvancedFormAutocompleteMultiInput","",1,"input-autocomplete","flex-grow-1",3,"field","off","suggestQuery","items","dropdown","itemsUpdate","keydown","keypress"],["dropdown",""],["itemTpl",""],[1,"badge","badge-pill","badge-secondary","align-self-center","mr-1"],[1,"fas","fa-times-circle","clickable",3,"click"],[1,"autocomplete-item","p-2"]],template:function(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"label"),t.ɵɵtext(2),t.ɵɵpipe(3,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"section",1),t.ɵɵelementStart(5,"div",2),t.ɵɵtemplate(6,V,3,1,"span",3),t.ɵɵelementStart(7,"input",4),t.ɵɵlistener("itemsUpdate",(function(e){return n.onItemsChanged(e)}))("keydown",(function(e){return n.keydown(e)}))("keypress",(function(e){return n.keypress(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"sq-autocomplete-list",null,5),t.ɵɵtemplate(10,E,2,1,"ng-template",null,6,t.ɵɵtemplateRefExtractor),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e){var i=t.ɵɵreference(9);t.ɵɵadvance(2),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(3,9,n.label)),t.ɵɵadvance(3),t.ɵɵproperty("field",n.field)("validationForm",n.form),t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",n.items),t.ɵɵadvance(1),t.ɵɵproperty("field",n.field)("off",!n.suggestQuery)("suggestQuery",n.suggestQuery)("items",n.items)("dropdown",i)}},directives:[b,c.NgForOf,A,l.BsAutocompleteList],pipes:[s.MessagePipe],styles:[".sq-dropdown-form[_ngcontent-%COMP%]{display:inline;min-width:13rem}.disabled[_ngcontent-%COMP%]{cursor:not-allowed}.clickable[_ngcontent-%COMP%]{cursor:pointer}.clickable[_ngcontent-%COMP%]:hover{opacity:1%}.multi-entry[_ngcontent-%COMP%]{align-items:center;display:flex;flex-wrap:wrap;height:unset!important;width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{border:none;flex-basis:100px;flex-grow:1;min-width:100px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}"]});var q=["fromTo"],M=["from"],O=["to"];function _(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",1),t.ɵɵelementStart(1,"div",2),t.ɵɵelementStart(2,"input",3,4),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().updateFromTo(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(2),t.ɵɵproperty("bsConfig",o.bsFromToConfig())("ngModel",o.value)("placeholder",o.dateFormat)}}function P(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",1),t.ɵɵelementStart(1,"div",5),t.ɵɵelementStart(2,"input",6,7),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().updateFrom(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",8),t.ɵɵtext(5),t.ɵɵpipe(6,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"div",5),t.ɵɵelementStart(8,"input",9,10),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().updateTo(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(2),t.ɵɵproperty("id",o.fromName)("bsConfig",o.bsFromConfig())("ngModel",o.value[0])("placeholder",o.dateFormat),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(6,9,"msg#advanced.dateRangePicker.separator")),t.ɵɵadvance(3),t.ɵɵproperty("id",o.toName)("bsConfig",o.bsToConfig())("ngModel",o.value[1])("placeholder",o.dateFormat)}}var N={provide:n.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return U})),multi:!0},U=function(){function e(e){this.intlService=e,this.SystemFormat="YYYY-MM-DD",this.onChangeCallback=function(){}}return e.prototype.ngOnInit=function(){this.options||(this.options={}),this.fromName="from_"+this.options.name,this.toName="to_"+this.options.name,this.value||(this.value=[void 0,void 0])},Object.defineProperty(e.prototype,"dateFormat",{get:function(){return this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")},enumerable:!1,configurable:!0}),e.prototype.setLocale=function(){this.fromToPicker&&this.fromToPicker.isOpen&&(this.fromToPicker.hide(),this.fromToPicker.show()),this.fromPicker&&this.fromPicker.isOpen&&(this.fromPicker.hide(),this.fromPicker.show()),this.toPicker&&this.toPicker.isOpen&&(this.toPicker.hide(),this.toPicker.show())},e.prototype.ngAfterViewInit=function(){var e=this;this.setLocale(),this.localeChange=i.Utils.subscribe(this.intlService.events,(function(t){e.setLocale()}))},e.prototype.ngOnDestroy=function(){this.localeChange&&this.localeChange.unsubscribe()},e.prototype.bsFromToConfig=function(){return{minDate:this.options.minDate,maxDate:this.options.maxDate,containerClass:"theme-default",showWeekNumbers:!1,rangeInputFormat:this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")}},e.prototype.updateFromTo=function(e){this.setValue([e?e[0]:void 0,e?e[1]:void 0]),this.onChangeCallback(this.value)},e.prototype.bsFromConfig=function(){return{minDate:this.options.minDate,maxDate:this.maxDate,containerClass:"theme-default",showWeekNumbers:!1,dateInputFormat:this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")}},e.prototype.bsToConfig=function(){return{minDate:this.minDate,maxDate:this.options.maxDate,containerClass:"theme-default",showWeekNumbers:!1,dateInputFormat:this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")}},e.prototype.setMinMaxDate=function(){this.maxDate=this.value[1]||this.options.maxDate,this.minDate=this.value[0]||this.options.minDate},e.prototype.resetMinMaxDate=function(){this.maxDate=this.options.maxDate,this.minDate=this.options.minDate},e.prototype.updateFrom=function(e){this.setValue([e,this.value[1]]),this.onChangeCallback(this.value)},e.prototype.updateTo=function(e){this.setValue([this.value[0],e]),this.onChangeCallback(this.value)},e.prototype.zeroTimes=function(){if(this.value){var e;if(i.Utils.isDate(this.value[0]))(e=this.value[0]).setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0);if(i.Utils.isDate(this.value[1]))(e=this.value[1]).setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}},e.prototype.setValue=function(e){this.value&&e&&i.Utils.equals(this.value[0],e[0])&&i.Utils.equals(this.value[1],e[1])||(e?(e[0]=e[0]?new Date(e[0]):e[0],e[1]=e[1]?new Date(e[1]):e[1]):e=[void 0,void 0],this.options.closedRange?(this.value=e,this.zeroTimes()):(this.resetMinMaxDate(),this.value=e,this.zeroTimes(),this.setMinMaxDate()))},e.prototype.writeValue=function(e){this.setValue(e)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){},e}();U.ɵfac=function(e){return new(e||U)(t.ɵɵdirectiveInject(s.IntlService))},U.ɵcmp=t.ɵɵdefineComponent({type:U,selectors:[["sq-date-range-picker"]],viewQuery:function(e,n){if(1&e&&(t.ɵɵviewQuery(q,!0),t.ɵɵviewQuery(M,!0),t.ɵɵviewQuery(O,!0)),2&e){var i=void 0;t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.fromToPicker=i.first),t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.fromPicker=i.first),t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.toPicker=i.first)}},inputs:{options:"options"},features:[t.ɵɵProvidersFeature([N])],decls:2,vars:2,consts:[["class","sq-date-range-picker form-row",4,"ngIf"],[1,"sq-date-range-picker","form-row"],[1,"col"],["type","text","autocomplete","off","bsDaterangepicker","","triggers","click",1,"form-control",3,"bsConfig","ngModel","placeholder","ngModelChange"],["fromTo","bsDaterangepicker"],[1,"col-auto"],["type","text","autocomplete","off","bsDatepicker","","triggers","click",1,"form-control","sq-range-from",3,"id","bsConfig","ngModel","placeholder","ngModelChange"],["from","bsDatepicker"],[1,"col-auto","sq-separator"],["type","text","autocomplete","off","bsDatepicker","","triggers","click",1,"form-control","sq-range-to",3,"id","bsConfig","ngModel","placeholder","ngModelChange"],["to","bsDatepicker"]],template:function(e,n){1&e&&(t.ɵɵtemplate(0,_,4,3,"div",0),t.ɵɵtemplate(1,P,10,11,"div",0)),2&e&&(t.ɵɵproperty("ngIf",n.options.closedRange),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.options.closedRange))},directives:[c.NgIf,d.BsDaterangepickerInputDirective,n.DefaultValueAccessor,d.BsDaterangepickerDirective,n.NgControlStatus,n.NgModel,d.BsDatepickerInputDirective,d.BsDatepickerDirective],pipes:[s.MessagePipe],encapsulation:2});var B=function(){return{standalone:!0}};function T(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",4),t.ɵɵelementStart(1,"div",5),t.ɵɵelementStart(2,"input",6),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().updateFrom(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",7),t.ɵɵtext(4),t.ɵɵpipe(5,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"div",5),t.ɵɵelementStart(7,"input",8),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().updateTo(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("field",o.field)("validationForm",o.form)("id",o.field),t.ɵɵadvance(2),t.ɵɵproperty("id",o.fromName)("ngModel",o.value[0])("ngModelOptions",t.ɵɵpureFunction0(12,B)),t.ɵɵadvance(2),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(5,10,"msg#advanced.rangeSeparator")),t.ɵɵadvance(3),t.ɵɵproperty("id",o.toName)("ngModel",o.value[1])("ngModelOptions",t.ɵɵpureFunction0(13,B))}}var R=function(e,t,n){return{name:e,system:!1,closedRange:!1,minDate:t,maxDate:n}};function j(e,n){if(1&e&&t.ɵɵelement(0,"sq-date-range-picker",9),2&e){var i=t.ɵɵnextContext();t.ɵɵproperty("options",t.ɵɵpureFunction3(5,R,i.field,i.minDate,i.maxDate))("formControlName",i.field)("id",i.field)("field",i.field)("validationForm",i.form)}}var L=function(){function e(e){this.appService=e}return e.prototype.ngOnInit=function(){var e=this;if(this.fromName="from_"+this.field,this.toName="to_"+this.field,this.forName=this.fromName,this.column=this.appService.getColumn(this.field),void 0===this.label&&(this.label=this.appService.getPluralLabel(this.field)),this.isDate=!!this.column&&o.AppService.isDate(this.column),this.isDate&&(this.minDate=i.Utils.isDate(this.min)?this.min:void 0,this.maxDate=i.Utils.isDate(this.max)?this.max:void 0),this.control=this.form.get(this.field),!this.control)throw new Error("No form control named "+this.field);this.value=this.control.value,this._valueChangesSubscription=i.Utils.subscribe(this.control.valueChanges,(function(t){e.value=t}))},e.prototype.ngOnDestroy=function(){this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe()},e.prototype.ensureValue=function(e){if(this.isDate){var t=i.Utils.toDate(e);if(void 0!==t)return t}else if(this.column&&o.AppService.isNumber(this.column)&&i.Utils.testFloat(e))return i.Utils.toNumber(e);return e},e.prototype.updateFrom=function(e){this.value[0]=this.ensureValue(e),this.control&&(this.control.markAsDirty(),this.control.setValue(this.value))},e.prototype.updateTo=function(e){this.value[1]=this.ensureValue(e),this.control&&(this.control.markAsDirty(),this.control.setValue(this.value))},e}();L.ɵfac=function(e){return new(e||L)(t.ɵɵdirectiveInject(o.AppService))},L.ɵcmp=t.ɵɵdefineComponent({type:L,selectors:[["sq-advanced-form-range"]],inputs:{form:"form",field:"field",min:"min",max:"max",label:"label"},decls:6,vars:7,consts:[[1,"form-group",3,"formGroup"],[3,"for"],["class","sq-advanced-form-range form-row","sqAdvancedFormValidation","",3,"field","validationForm","id",4,"ngIf"],["sqAdvancedFormValidation","",3,"options","formControlName","id","field","validationForm",4,"ngIf"],["sqAdvancedFormValidation","",1,"sq-advanced-form-range","form-row",3,"field","validationForm","id"],[1,"col-auto","d-flex","flex-column"],["type","text","autocomplete","off","spellcheck","off",1,"form-control","sq-range-from",3,"id","ngModel","ngModelOptions","ngModelChange"],[1,"col-auto","sq-separator"],["type","text","autocomplete","off","spellcheck","off",1,"form-control","sq-range-to",3,"id","ngModel","ngModelOptions","ngModelChange"],["sqAdvancedFormValidation","",3,"options","formControlName","id","field","validationForm"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"label",1),t.ɵɵtext(2),t.ɵɵpipe(3,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵtemplate(4,T,8,14,"div",2),t.ɵɵtemplate(5,j,1,9,"sq-date-range-picker",3),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("formGroup",n.form),t.ɵɵadvance(1),t.ɵɵpropertyInterpolate("for",n.forName),t.ɵɵadvance(1),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(3,5,n.label)),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",!n.isDate),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.isDate))},directives:[n.NgControlStatusGroup,n.FormGroupDirective,c.NgIf,b,n.DefaultValueAccessor,n.NgControlStatus,n.NgModel,U,n.FormControlName],pipes:[s.MessagePipe],encapsulation:2});var Q=["button"],z=function(e,t){return{active:e,first:t}};function G(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"a",7),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.index;return t.ɵɵnextContext(2).toggleItemSelected(e)}))("keydown",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext(2).keydown(e)})),t.ɵɵelement(1,"span"),t.ɵɵelementStart(2,"span"),t.ɵɵtext(3),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=n.$implicit,r=n.index,a=t.ɵɵnextContext(2);t.ɵɵclassMapInterpolate1("dropdown-item",a.activeItem===r?" active":"",""),t.ɵɵproperty("sqScrollIntoView",t.ɵɵpureFunction2(8,z,r===a.activeItem,0===r)),t.ɵɵadvance(1),t.ɵɵclassMapInterpolate1("fas fa-check ",a.isItemSelected(r)?"":" invisible"," left"),t.ɵɵadvance(2),t.ɵɵtextInterpolate(o)}}function K(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",5),t.ɵɵlistener("mousedown",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().mousedown(e)})),t.ɵɵtemplate(1,G,4,11,"a",6),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵstyleProp("max-height",o.itemListHeight),t.ɵɵproperty("hidden",!o.isOpen),t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",o.names)}}var Y=function(){function e(){this.opened=!1,this.isOpen=!1,this.activeItem=-1,this.cancelBlur=!1,this.onChangeCallback=function(){}}return e.prototype.ngOnInit=function(){var e=this;this.clearSelected(),0===this.items.length&&(this.disabled=!1),this.names=[],this.items.forEach((function(t){return e.names.push(t.display)}))},e.prototype.setOpen=function(e){if(!this.opened){if(this.disabled||!e)return;this.opened=!0}this.isOpen=e,e||(this.activeItem=-1)},e.prototype.mousedown=function(e){var t=this;e.preventDefault(),this.cancelBlur=!0,i.Utils.delay().then((function(){return t.cancelBlur=!1}))},e.prototype.blur=function(e){var t=this;if(this.cancelBlur)return e.preventDefault(),e.stopImmediatePropagation(),void i.Utils.delay().then((function(){t.buttonElement.nativeElement.focus()}));this.setOpen(!1)},e.prototype.toggleOpen=function(){this.disabled||this.setOpen(!this.isOpen)},e.prototype.keydown=function(e){this.disabled||(e.keyCode===i.Keys.down?(this.isOpen||this.setOpen(!0),this.activeItem++,this.activeItem>=this.items.length&&(this.activeItem=0),e.preventDefault(),e.stopPropagation()):e.keyCode===i.Keys.up?(this.isOpen||this.setOpen(!0),this.activeItem--,this.activeItem<0&&(this.activeItem=this.items.length-1),e.preventDefault(),e.stopPropagation()):(e.keyCode===i.Keys.enter||e.keyCode===i.Keys.space)&&this.activeItem>=0&&this.activeItem<this.items.length?(this.toggleItemSelected(this.activeItem),e.preventDefault(),e.stopPropagation()):e.keyCode===i.Keys.esc&&this.isOpen&&(this.setOpen(!1),e.preventDefault(),e.stopPropagation()))},e.prototype.clearSelected=function(){this.selectedItems=[]},e.prototype.countSelected=function(){return this.selectedItems.length},e.prototype.isItemSelected=function(e){return this.selectedItems.includes(e)},e.prototype.toggleItemSelected=function(e){var t=this.selectedItems.indexOf(e);t>-1?this.selectedItems.splice(t,1):this.multiple?(this.selectedItems.push(e),this.activeItem>=0&&(this.activeItem=e)):(this.selectedItems=[e],this.setOpen(!1)),this.triggerOnChange()},Object.defineProperty(e.prototype,"buttonTitleMessageParams",{get:function(){return{values:{count:this.countSelected()}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buttonTitle",{get:function(){var e=this,t=this.countSelected();return 0===t?"msg#advanced.select.noItems":this.multiple?t===this.items.length?"msg#advanced.select.allItems":this.selectedItems.map((function(t){return e.items[t].display})).sort().join(", "):this.items[this.selectedItems[0]].display},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemListHeight",{get:function(){return"40ex"},enumerable:!1,configurable:!0}),e.prototype.triggerOnChange=function(){var e,t=this;e=0===this.selectedItems.length?void 0:this.multiple?this.selectedItems.map((function(e){return t.items[e]})):this.items[this.selectedItems[0]],this.onChangeCallback(e)},e.prototype.writeValue=function(e){var t=this;if(this.clearSelected(),e){var n=Array.isArray(e)?e:[e];this.items.forEach((function(e,i){n.find((function(t){return t.value===e.value}))&&void 0!==i&&t.selectedItems.push(i)}))}},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){},e}();Y.ɵfac=function(e){return new(e||Y)},Y.ɵcmp=t.ɵɵdefineComponent({type:Y,selectors:[["sq-select"]],viewQuery:function(e,n){if(1&e&&t.ɵɵviewQuery(Q,!0),2&e){var i;t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.buttonElement=i.first)}},inputs:{items:"items",disabled:"disabled",multiple:"multiple"},features:[t.ɵɵProvidersFeature([{provide:n.NG_VALUE_ACCESSOR,multi:!0,useExisting:t.forwardRef((function(){return Y}))}])],decls:7,vars:8,consts:[[1,"dropdown"],["data-toggle","dropdown","type","button","role","button","tabindex","0",3,"click","blur","keydown"],["button",""],[1,"sq-button-text"],["class","dropdown-menu dropdown-menu-left show","role","combobox",3,"hidden","max-height","mousedown",4,"ngIf"],["role","combobox",1,"dropdown-menu","dropdown-menu-left","show",3,"hidden","mousedown"],["tabindex","-1",3,"class","sqScrollIntoView","click","keydown",4,"ngFor","ngForOf"],["tabindex","-1",3,"sqScrollIntoView","click","keydown"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"button",1,2),t.ɵɵlistener("click",(function(){return n.toggleOpen()}))("blur",(function(e){return n.blur(e)}))("keydown",(function(e){return n.keydown(e)})),t.ɵɵelementStart(3,"span",3),t.ɵɵtext(4),t.ɵɵpipe(5,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(6,K,2,4,"div",4),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(1),t.ɵɵclassMapInterpolate1("btn btn-light ",n.disabled?" disabled":""," dropdown-toggle form-control"),t.ɵɵadvance(3),t.ɵɵtextInterpolate(t.ɵɵpipeBind2(5,5,n.buttonTitle,n.buttonTitleMessageParams)),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.opened))},directives:[c.NgIf,c.NgForOf,u.ScrollIntoView],pipes:[s.MessagePipe],encapsulation:2});var $=function(){function e(e,t){this.appService=e,this.firstPageService=t}return e.prototype.ngOnInit=function(){if(!this.form.get(this.field))throw new Error("No control in search-form named "+this.field);this.column=this.appService.getColumn(this.field),this.items=this.getItems(),void 0===this.label&&(this.multiple?this.label=this.appService.getPluralLabel(this.field):this.label=this.appService.getLabel(this.field))},e.prototype.ngOnDestroy=function(){this._valueChangesSubscription&&this._valueChangesSubscription.unsubscribe()},e.prototype.getItems=function(){var e=this,t=this.firstPageService.firstPage;if(t){var n=this.aggregation?function(t){return i.Utils.eqNC(t.name,e.aggregation)}:function(t){return e.column&&i.Utils.eqNC(t.column,e.column.name)},o=t.aggregations.find(n);if(o&&o.items)return o.items.filter((function(e){return!i.Utils.isArray(e.value)&&!!e.value})).map((function(e){return{value:e.value,display:e.display?e.display:e.value.toString()}}))}return[]},e}();$.ɵfac=function(e){return new(e||$)(t.ɵɵdirectiveInject(o.AppService),t.ɵɵdirectiveInject(r.FirstPageService))},$.ɵcmp=t.ɵɵdefineComponent({type:$,selectors:[["sq-advanced-form-select"]],inputs:{form:"form",field:"field",label:"label",multiple:"multiple",aggregation:"aggregation"},decls:5,vars:11,consts:[[1,"form-group",3,"formGroup"],[3,"for"],["sqAdvancedFormValidation","",3,"items","multiple","formControlName","id","field","validationForm"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"label",1),t.ɵɵtext(2),t.ɵɵpipe(3,"sqMessage"),t.ɵɵelementEnd(),t.ɵɵelement(4,"sq-select",2),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("formGroup",n.form),t.ɵɵadvance(1),t.ɵɵpropertyInterpolate("for",n.field),t.ɵɵadvance(1),t.ɵɵtextInterpolate(t.ɵɵpipeBind1(3,9,n.label)),t.ɵɵadvance(2),t.ɵɵproperty("items",n.items)("multiple",n.multiple)("formControlName",n.field)("id",n.field)("field",n.field)("validationForm",n.form))},directives:[n.NgControlStatusGroup,n.FormGroupDirective,Y,b,n.NgControlStatus,n.FormControlName],pipes:[s.MessagePipe],encapsulation:2});var H=["picker"],W=["input"],J={provide:n.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return X})),multi:!0},X=function(){function e(e){this.intlService=e,this.SystemFormat="YYYY-MM-DD",this.onChangeCallback=function(){}}return e.prototype.ngOnInit=function(){this.options||(this.options={})},Object.defineProperty(e.prototype,"dateFormat",{get:function(){return this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")},enumerable:!1,configurable:!0}),e.prototype.setLocale=function(){this.picker&&this.picker.isOpen&&(this.picker.hide(),this.picker.show())},e.prototype.ngAfterViewInit=function(){var e=this;this.setLocale(),this.localeChange=i.Utils.subscribe(this.intlService.events,(function(t){e.setLocale()}))},e.prototype.ngOnDestroy=function(){this.localeChange&&this.localeChange.unsubscribe()},e.prototype.bsConfig=function(){return{minDate:this.options.minDate,maxDate:this.options.maxDate,containerClass:"theme-default",showWeekNumbers:!1,dateInputFormat:this.options.system?this.SystemFormat:f.default.localeData().longDateFormat("L")}},e.prototype.updateValue=function(e){this.value=e,this.zeroTimes(this.value),this.onChangeCallback(this.value),this.focus()},e.prototype.zeroTimes=function(e){i.Utils.isDate(e)&&e.setHours(0,0,0,0)},e.prototype.focus=function(){this.input&&this.input.nativeElement.focus()},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){},e}();X.ɵfac=function(e){return new(e||X)(t.ɵɵdirectiveInject(s.IntlService))},X.ɵcmp=t.ɵɵdefineComponent({type:X,selectors:[["sq-date-picker"]],viewQuery:function(e,n){if(1&e&&(t.ɵɵviewQuery(H,!0),t.ɵɵviewQuery(W,!0)),2&e){var i=void 0;t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.picker=i.first),t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.input=i.first)}},inputs:{options:"options"},features:[t.ɵɵProvidersFeature([J])],decls:5,vars:3,consts:[[1,"sq-date-picker","form-row"],[1,"col"],["type","text","autocomplete","off","bsDatepicker","","triggers","click",1,"form-control",3,"bsConfig","ngModel","placeholder","ngModelChange"],["input","","picker","bsDatepicker"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵelementStart(2,"input",2,3),t.ɵɵlistener("ngModelChange",(function(e){return n.updateValue(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(2),t.ɵɵproperty("bsConfig",n.bsConfig())("ngModel",n.value)("placeholder",n.dateFormat))},directives:[d.BsDatepickerInputDirective,n.DefaultValueAccessor,d.BsDatepickerDirective,n.NgControlStatus,n.NgModel],encapsulation:2});var Z=function(){};Z.ɵmod=t.ɵɵdefineNgModule({type:Z}),Z.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||Z)},imports:[[c.CommonModule,n.FormsModule,n.ReactiveFormsModule,s.IntlModule,d.BsDatepickerModule.forRoot(),u.UtilsModule,l.BsAutocompleteModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(Z,{declarations:[I,k,L,$,F,X,U,Y,A,x,b],imports:[c.CommonModule,n.FormsModule,n.ReactiveFormsModule,s.IntlModule,d.BsDatepickerModule,u.UtilsModule,l.BsAutocompleteModule],exports:[I,k,L,$,F,X,U,Y,A,x,b]});var ee=i.Utils.merge({},{advanced:{rangeSeparator:" / ",dateRangePicker:{separator:" / "},rangeInput:{separator:"/"},select:{nItems:"{count} items selected",allItems:"All items selected",noItems:"No items selected"}}},r.enSearch),te=i.Utils.merge({},{advanced:{rangeSeparator:" / ",dateRangePicker:{separator:" / "},rangeInput:{separator:"/"},select:{nItems:"{count} éléments sélectionnés",allItems:"Tous les éléments",noItems:"Aucun élément"}}},r.frSearch),ne=i.Utils.merge({},{advanced:{rangeSeparator:" / ",dateRangePicker:{separator:" / "},rangeInput:{separator:"/"},select:{nItems:"{count} Elemente ausgewählt",allItems:"Alle Elemenente ausgewählt",noItems:"Keine Elemente ausgewählt"}}},r.deSearch);e.AdvancedService=h,e.BsAdvancedFormAutocomplete=x,e.BsAdvancedFormAutocompleteMultiInput=A,e.BsAdvancedFormCheckbox=I,e.BsAdvancedFormInput=k,e.BsAdvancedFormMultiInput=F,e.BsAdvancedFormRange=L,e.BsAdvancedFormSelect=$,e.BsAdvancedFormValidation=b,e.BsAdvancedModule=Z,e.BsDatePicker=X,e.BsDateRangePicker=U,e.BsSelectComponent=Y,e.DATE_PICKER_VALUE_ACCESSOR=J,e.DATE_RANGE_PICKER_VALUE_ACCESSOR=N,e.deAdvanced=ne,e.enAdvanced=ee,e.frAdvanced=te,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sinequa-components-advanced.umd.min.js.map