<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Components</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Components</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content directive">
                   <div class="content-data">






<ol class="breadcrumb">
  <li>Directives</li>
  <li>LabelsAutocomplete</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>labels/labels-autocomplete.directive.ts</code>
        </p>


            <p class="comment">
                <h3>Implements</h3>
            </p>
            <p class="comment">
                            <code><a href="https://angular.io/api/core/OnInit" target="_blank" >OnInit</a></code>
                            <code><a href="https://angular.io/api/core/OnChanges" target="_blank" >OnChanges</a></code>
            </p>


        <section>
            <h3>Metadata</h3>
            <table class="table table-sm table-hover">
                <tbody>

                    <tr>
                        <td class="col-md-3">Selector</td>
                        <td class="col-md-9"><code>[sqAutocompleteLabels]</code></td>
                    </tr>

                </tbody>
            </table>
        </section>

            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#keydown">keydown</a>
                            </li>
                            <li>
                                <a href="#ngOnChanges">ngOnChanges</a>
                            </li>
                            <li>
                                <a href="#ngOnInit">ngOnInit</a>
                            </li>
                            <li>
                                <a href="#updatePlaceholder">updatePlaceholder</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Inputs</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#allowManagePublicLabels">allowManagePublicLabels</a>
                            </li>
                            <li>
                                <a href="#allowNewLabels">allowNewLabels</a>
                            </li>
                            <li>
                                <a href="#labelsItems">labelsItems</a>
                            </li>
                            <li>
                                <a href="#public">public</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Outputs</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#itemsUpdate">itemsUpdate</a>
                            </li>
                        </ul>
                    </td>
                </tr>


                <tr>
                    <td class="col-md-4">
                        <h6><b>HostListeners</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#blur">blur</a>
                            </li>
                            <li>
                                <a href="#focus">focus</a>
                            </li>
                            <li>
                                <a href="#input">input</a>
                            </li>
                        </ul>
                    </td>
                </tr>

        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(elementRef: <a href="https://angular.io/api/core/ElementRef" target="_blank">ElementRef</a>, suggestService: <a href="../injectables/SuggestService.html">SuggestService</a>, appService: AppService, uiService: <a href="../injectables/UIService.html">UIService</a>, labelsWebService: <a href="../components/Labels.html">LabelsWebService</a>, labelsService: <a href="../injectables/LabelsService.html">LabelsService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="44" class="link-to-prism">labels/labels-autocomplete.directive.ts:44</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>elementRef</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://angular.io/api/core/ElementRef" target="_blank" >ElementRef</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>suggestService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/SuggestService.html" target="_self" >SuggestService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>appService</td>
                                                  
                                                        <td>
                                                                    <code>AppService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>uiService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UIService.html" target="_self" >UIService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>labelsWebService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../components/Labels.html" target="_self" >LabelsWebService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>labelsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/LabelsService.html" target="_self" >LabelsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    <h3 id="inputs">Inputs</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="allowManagePublicLabels"></a>
                        <b>allowManagePublicLabels</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>false</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="38" class="link-to-prism">labels/labels-autocomplete.directive.ts:38</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Define the right of adding new labels in labelsItems or not </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="allowNewLabels"></a>
                        <b>allowNewLabels</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>false</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">labels/labels-autocomplete.directive.ts:35</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Enable adding new labels in labelsItems or not </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="labelsItems"></a>
                        <b>labelsItems</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/AutocompleteItem.html" target="_self" >AutocompleteItem[]</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>[]</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">labels/labels-autocomplete.directive.ts:41</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Stores the selected labels items selected via Tab </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="public"></a>
                        <b>public</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">labels/labels-autocomplete.directive.ts:32</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Whether the labels are public or not </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>
            <section>
    <h3 id="outputs">Outputs</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="itemsUpdate"></a>
                        <b>itemsUpdate</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">labels/labels-autocomplete.directive.ts:29</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Event synchronizing the list of selected labels in the parent component </p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    <h3>HostListeners</h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="blur"></a>
                    <span class="name">
                        <b>
                            blur
                        </b>
                        <a href="#blur"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <i>Arguments : </i><code>'$event' </code>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>blur(event: FocusEvent)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="266"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:266</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Listens to blur events (out of focus) on the <input> host and overrides the parent blur events</p>
</div>

                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="focus"></a>
                    <span class="name">
                        <b>
                            focus
                        </b>
                        <a href="#focus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>focus()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="258"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:258</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Listens to focus events on the <input> host and overrides the parent focus events in order to launch the autocomplete
If empty input :</p>
<ul>
<li>display top relevent labels if the auto-suggest wildcard is configured</li>
<li>restart the autocomplete if no auto-suggest wildcard is found
If not empty input :
retrieve suggestions based on this input text</li>
</ul>
</div>

                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="input"></a>
                    <span class="name">
                        <b>
                            input
                        </b>
                        <a href="#input"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <i>Arguments : </i><code>'$event' </code>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>input(event: <a href="../interfaces/Event.html">Event</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="275"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:275</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Overrides the parent inputChanged method, so that it is possible to reinitialize the autocomplete</p>
</div>

                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="keydown"></a>
                    <span class="name">
                        <b>
                            keydown
                        </b>
                        <a href="#keydown"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>keydown(event: KeyboardEvent)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="230"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:230</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Listen to user&#39;s keyboard actions in the <input>, in order to navigate
and select the autocomplete suggestions.
Overrides the parent keydown method, adds the management of the backspace key
to remove labels items, enhance the enter key to support adding new labels.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>event</td>
                                    <td>
                                            <code>KeyboardEvent</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the keyboard</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ngOnChanges"></a>
                    <span class="name">
                        <b>
                            ngOnChanges
                        </b>
                        <a href="#ngOnChanges"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>ngOnChanges(changes: <a href="https://angular.io/api/core/SimpleChanges" target="_blank">SimpleChanges</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="73"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:73</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>If the inputs changes state, react accordingly</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>changes</td>
                                    <td>
                                                <code><a href="https://angular.io/api/core/SimpleChanges" target="_blank" >SimpleChanges</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ngOnInit"></a>
                    <span class="name">
                        <b>
                            ngOnInit
                        </b>
                        <a href="#ngOnInit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>ngOnInit()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="62"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:62</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>The ngOnInit() method from the original directive is overriden
On initialization, we listen to the autocomplete component for
selection events</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updatePlaceholder"></a>
                    <span class="name">
                        <b>
                            updatePlaceholder
                        </b>
                        <a href="#updatePlaceholder"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>updatePlaceholder()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="297"
                            class="link-to-prism">labels/labels-autocomplete.directive.ts:297</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Updates the <input>&#39;s placeholder to avoid displaying something
when there are labelsItems displayed to the left.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>


    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
    Directive,
    ElementRef,
    Input,
    EventEmitter,
    SimpleChanges,
    Output,
    HostListener,
    OnInit,
    OnChanges,
} from &quot;@angular/core&quot;;
import {
    Autocomplete,
    SuggestService,
    AutocompleteState,
    AutocompleteItem,
} from &quot;@sinequa/components/autocomplete&quot;;
import { AppService } from &quot;@sinequa/core/app-utils&quot;;
import { UIService } from &quot;@sinequa/components/utils&quot;;
import { LabelsWebService, Labels } from &quot;@sinequa/core/web-services&quot;;
import { Keys } from &quot;@sinequa/core/base&quot;;
import { LabelsService } from &quot;./labels.service&quot;;

@Directive({
    selector: &quot;[sqAutocompleteLabels]&quot;,
})
export class LabelsAutocomplete extends Autocomplete implements OnInit, OnChanges {
    /** Event synchronizing the list of selected labels in the parent component */
    @Output() itemsUpdate &#x3D; new EventEmitter&lt;AutocompleteItem[]&gt;();

    /** Whether the labels are public or not */
    @Input() public: boolean;

    /** Enable adding new labels in labelsItems or not */
    @Input() allowNewLabels: boolean &#x3D; false;

    /** Define the right of adding new labels in labelsItems or not */
    @Input() allowManagePublicLabels: boolean &#x3D; false;

    /** Stores the selected labels items selected via Tab */
    @Input() labelsItems: AutocompleteItem[] &#x3D; [];

    /** Stores the suggestions retrieved by th server in order to perform checks on key.enter events */
    private _suggestions: string[] &#x3D; [];

    constructor(
        elementRef: ElementRef,
        suggestService: SuggestService,
        appService: AppService,
        uiService: UIService,
        private labelsWebService: LabelsWebService,
        private labelsService: LabelsService
    ) {
        super(elementRef, suggestService, appService, uiService);
    }

    /**
     * The ngOnInit() method from the original directive is overriden
     * On initialization, we listen to the autocomplete component for
     * selection events
     */
    ngOnInit() {
        this._dropdownSubscription &#x3D; this.dropdown.clicked.subscribe((item) &#x3D;&gt; {
            this.select(item, true); // An item was selected from the autocomplete &#x3D;&gt; take the value
        });
        this.start();
    }

    /**
     * If the inputs changes state, react accordingly
     * @param changes
     */
    ngOnChanges(changes: SimpleChanges) {
        if (changes[&quot;labelsItems&quot;]) {
            this.updatePlaceholder();
        }

        // Override start() by using init() instead, so that no double queries are generated and autocomplete dropdown is shown only on focus
        if (changes[&quot;off&quot;] &amp;&amp; !this.off) {
            this.init();
        }

        // If labels category changes, we must remove the selected labels items and reinitialize the autocomplete
        if (changes[&quot;public&quot;] &amp;&amp; !changes[&quot;public&quot;].firstChange) {
            const newInitLabels &#x3D; [...changes[&quot;labelsItems&quot;].currentValue];
            this.inputElement.blur();
            /** Reset the input Value*/
            this.setInputValue(&quot;&quot;);
            /** initialize the input needed specially for labels edit cases */
            this.updatePlaceholder();
            this.itemsUpdate.next(newInitLabels);
        }
    }

    /**
     * The getSuggests() method from the original directive is overriden to
     * use the labelsService rather than suggest service.
     */
    protected getSuggests() {
        const value &#x3D; this.getInputValue();

        if (value) {
            // parse
            const labels &#x3D; value.split(&quot;;&quot;);

            // find label at caret location
            const position &#x3D; this.getInputPosition();
            let length &#x3D; 0;
            let val:
                | { value: string, start: number, length: number }
                | undefined;
            for (const label of labels) {
                if (position &gt;&#x3D; length &amp;&amp; position &lt;&#x3D; length + label.length) {
                    val &#x3D; {
                        value: label,
                        start: length,
                        length: label.length,
                    };
                    break;
                }
                length +&#x3D; label.length + 1;
            }

            // Get suggestions from web service
            if (val) {
                this._getLabelsSuggestions(val.value);
            }
        } else {
            if (!!this.labelsService.labelsAutoSuggestWildcard) {
                this._getLabelsSuggestions(
                    this.labelsService.labelsAutoSuggestWildcard
                );
            } else {
                this.start();
            }
        }
    }

    private _getLabelsSuggestions(val: string) {
        this.labelsWebService.list(val, this.public).subscribe(
            (labels: Labels) &#x3D;&gt; {
                if (
                    this.getState() &#x3D;&#x3D;&#x3D; AutocompleteState.ACTIVE ||
                    this.getState() &#x3D;&#x3D;&#x3D; AutocompleteState.OPENED
                ) {
                    /** Eliminate suggestions that are already selected */
                    labels.labels &#x3D; labels.labels.filter(
                        (label) &#x3D;&gt;
                            !this.labelsItems.find(
                                (item) &#x3D;&gt; item.display &#x3D;&#x3D;&#x3D; label
                            )
                    );

                    /** update the local list of suggestions */
                    this._suggestions &#x3D; labels.labels;

                    /** limit the suggestions to be displayed to 10  */
                    labels.labels &#x3D; labels.labels.slice(0, 10);

                    this.dropdown.update(
                        true,
                        labels.labels.map((label) &#x3D;&gt; {
                            return {
                                display: label,
                                category: &quot;&quot;,
                            };
                        })
                    );
                }
            },
            () &#x3D;&gt; {
                this.dropdown.update(false);
            },
            () &#x3D;&gt; {
                if (
                    this.dropdown.hasItems &amp;&amp;
                    this.getState() &#x3D;&#x3D;&#x3D; AutocompleteState.ACTIVE
                ) {
                    this.open(); // Switch from ACTIVE to OPENED (if not already)
                } else if (
                    !this.dropdown.hasItems &amp;&amp;
                    this.getState() &#x3D;&#x3D;&#x3D; AutocompleteState.OPENED
                ) {
                    // No data
                    this.active(); // Switch from OPENED to ACTIVE (if not already)
                }
            }
        );
    }

    /**
     * The setAutocompleteItem() method from the original directive is overriden to
     * Sets the content of the &lt;input&gt; based on the given
     * Autocomplete Item.
     * @returns false since labels items don&#x27;t need to be searched
     */
    protected setAutocompleteItem(item: AutocompleteItem): boolean {
        if (item) {
            // Store the autocomplete items that will be used to create a selection
            this.labelsItems.push(item);
            this.updatePlaceholder();
            this.itemsUpdate.next(this.labelsItems);
            this.setInputValue(&quot;&quot;);
        }
        return false;
    }

    /**
     * The startOrActive() method from the original directive is overriden to
     * immediately switch to ACTIVE if it is not the case
     */
    protected startOrActive(): void {
        if (
            this.getState() !&#x3D;&#x3D; AutocompleteState.ACTIVE &amp;&amp;
            this.getState() !&#x3D;&#x3D; AutocompleteState.OPENED
        ) {
            // Avoid flickering
            this.start();
            this.active();
        }
    }

    /**
     * Listen to user&#x27;s keyboard actions in the &lt;input&gt;, in order to navigate
     * and select the autocomplete suggestions.
     * Overrides the parent keydown method, adds the management of the backspace key
     * to remove labels items, enhance the enter key to support adding new labels.
     * @param event the keyboard
     */
    keydown(event: KeyboardEvent) {
        const keydown &#x3D; super.keydown(event);

        if (keydown &#x3D;&#x3D;&#x3D; undefined) {
            //We can remove selections by typing &lt;backspace&gt; when the input is empty
            if (event.keyCode &#x3D;&#x3D;&#x3D; Keys.backspace) {
                if (this.getInputValue() &#x3D;&#x3D;&#x3D; &quot;&quot;) {
                    this.labelsItems.pop();
                    this.updatePlaceholder();
                    this.itemsUpdate.next(this.labelsItems);
                }
            }
            /** Allow the selection one of new labels that not exists in the list */
            if (event.keyCode &#x3D;&#x3D;&#x3D; Keys.enter) {
                this._manageSetAutocompleteItem();
            }
        }
        return keydown;
    }

    /**
     * Listens to focus events on the &lt;input&gt; host and overrides the parent focus events in order to launch the autocomplete
     * If empty input :
     * - display top relevent labels if the auto-suggest wildcard is configured
     * - restart the autocomplete if no auto-suggest wildcard is found
     * If not empty input :
     * retrieve suggestions based on this input text
     */
    @HostListener(&quot;focus&quot;) focus() {
        this.start();
        this.active();
    }

    /**
     * Listens to blur events (out of focus) on the &lt;input&gt; host and overrides the parent blur events
     */
    @HostListener(&quot;blur&quot;, [&quot;$event&quot;]) blur(event: FocusEvent) {
        this._manageSetAutocompleteItem();
        this.init();
    }

    /**
     * Overrides the parent inputChanged method, so that it is possible to reinitialize the autocomplete
     * @param event
     */
    @HostListener(&quot;input&quot;, [&quot;$event&quot;]) inputChanged(event: Event) {
        switch (this.getState()) {
            case AutocompleteState.OPENED:
                this.suggest(); // Just request more data, but no state change
                break;
            case AutocompleteState.START:
            case AutocompleteState.ACTIVE:
                this.active(); // get more data, and change state if not already ACTIVE
                break;
            case AutocompleteState.SELECTED:
                this.start(); // The model changed because we selected a value &#x3D;&#x3D;&gt; we restart in case the user keeps typing
                this.active();
                break;
            case AutocompleteState.INIT:
                break;
        }
    }

    /**
     * Updates the &lt;input&gt;&#x27;s placeholder to avoid displaying something
     * when there are labelsItems displayed to the left.
     */
    updatePlaceholder() {
        this._placeholder &#x3D; this.labelsItems.length &gt; 0 ? &quot;&quot; : this.placeholder;
    }

    private _manageSetAutocompleteItem(): void {
        /** Always consider if there is text in the &lt;input&gt; and that it is not yet added in the labelsItems  */
        if (!!this.getInputValue() &amp;&amp; this.getInputValue() !&#x3D;&#x3D; &quot;&quot;) {
            if (this.allowNewLabels) {
                /** When it is an add Labels action &#x3D;&#x3D;&gt; check the privilege to create new label */
                if (
                    !this.public ||
                    (this.public &amp;&amp; this.allowManagePublicLabels)
                ) {
                    this.setAutocompleteItem({
                        display: this.getInputValue(),
                        category: &quot;&quot;,
                    });
                }
            } else {
                /** For all other actions on the labels, check if the typed text equals an existing label in the _suggestions  */
                if (this._suggestions.indexOf(this.getInputValue()) &gt; -1) {
                    this.setAutocompleteItem({
                        display: this.getInputValue(),
                        category: &quot;&quot;,
                    });
                }
            }
        }
    }
}
</code></pre>
    </div>

</div>








                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'directive';
            var COMPODOC_CURRENT_PAGE_URL = 'LabelsAutocomplete.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
